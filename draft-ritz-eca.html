<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Entity and Compute Attestation (ECA)</title>
<meta content="Nathanael Ritz" name="author">
<meta content="Muhammad Usama Sardar" name="author">
<meta content="
       When distributing complex workloads across diverse service providers, a platform-agnostic identity bound to verifiable proof enables operators to decouple access control from underlying infrastructure without compromising security postures at scale. Likewise, it may be desirable to challenge any long-running workload to a dynamic health check in order to maintain assurances of its trustworthiness over time. 
       This document specifies Entity and Compute Attestation (ECA), a protocol whose properties are being formally modelled that profiles RATS architecture to address both needs. ECA defines an identity bootstrap procedure where Attester and Verifier collaboratively act as an Identity Supplier to establish an emergent and cryptographically verifiable identity without the use of shared secrets like bearer tokens. The protocol utilizes attested TLS protocol   to define an attestation renewal procedure providing single round-trip verification bound to (D)TLS sessions via TLS Exported Authenticators that directly enables continuous attestation over time. 
       ECA is designed as a supporting component for frameworks like WIMSE and to enhance related projects such as SPIFFE/SPIRE. The security properties of both procedures are being formally analyzed (see Appendix A). 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="draft-ritz-eca-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.3
    ConfigArgParse 1.7.1
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.2.14
    weasyprint 65.0
-->
<link href="draft-ritz-eca.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://static.ietf.org/fonts/noto-sans/import.css'); /* Sans-serif */
@import url('https://static.ietf.org/fonts/noto-serif/import.css'); /* Serif (print) */
@import url('https://static.ietf.org/fonts/roboto-mono/import.css'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
@media print {
  svg {
    max-height: 850px;
    max-width: 660px;
  }
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    max-width: 100%;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > blockquote:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ECA</td>
<td class="right">October 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ritz &amp; Sardar</td>
<td class="center">Expires 21 April 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ritz-eca-01</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-10-18" class="published">18 October 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-04-21">21 April 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">N. Ritz</div>
<div class="org">Independent</div>
</div>
<div class="author">
      <div class="author-name">M. U. Sardar</div>
<div class="org">TU Dresden</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Entity and Compute Attestation (ECA)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">When distributing complex workloads across diverse service providers, a platform-agnostic identity bound to verifiable proof enables operators to decouple access control from underlying infrastructure without compromising security postures at scale. Likewise, it may be desirable to challenge any long-running workload to a dynamic health check in order to maintain assurances of its trustworthiness over time.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document specifies Entity and Compute Attestation (ECA), a protocol whose properties are being formally modelled that profiles RATS architecture to address both needs. ECA defines an identity bootstrap procedure where Attester and Verifier collaboratively act as an Identity Supplier to establish an emergent and cryptographically verifiable identity without the use of shared secrets like bearer tokens. The protocol utilizes attested TLS protocol <span>[<a href="#I-D.fossati-tls-exported-attestation" class="cite xref">I-D.fossati-tls-exported-attestation</a>]</span> to define an attestation renewal procedure providing single round-trip verification bound to (D)TLS sessions via TLS Exported Authenticators that directly enables continuous attestation over time.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">ECA is designed as a supporting component for frameworks like WIMSE and to enhance related projects such as SPIFFE/SPIRE. The security properties of both procedures are being formally analyzed (see Appendix A).<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 April 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-motivation-and-use-cases" class="internal xref">Motivation and Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-architectural-boundary-mult" class="internal xref">Architectural Boundary: Multi-Cloud and Heterogeneous Environments</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-architectural-flaw-the-prov" class="internal xref">Architectural Flaw: The Provisioning Race Condition</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-continuous-tee-verification" class="internal xref">Continuous TEE Verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-non-goals" class="internal xref">Non-Goals</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-conceptual-model-informatio" class="internal xref">Conceptual Model (Informational)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-eca-protocol-factors-refere" class="internal xref">ECA Protocol Factors Reference Table</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-attestation-lifecycle" class="internal xref">Attestation Lifecycle</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-identity-bootstrap-procedur" class="internal xref">Identity Bootstrap Procedure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-attestation-renewal-procedu" class="internal xref">Attestation Renewal Procedure</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-credential-lifecycle-progre" class="internal xref">Credential Lifecycle Progression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-key-cryptographic-propertie" class="internal xref">Key Cryptographic Properties</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-factor-independence" class="internal xref">Factor Independence</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-progressive-trust" class="internal xref">Progressive Trust</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-exposure-tolerance" class="internal xref">Exposure Tolerance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="auto internal xref">4.4.4</a>.  <a href="#name-security-properties-of-comp" class="internal xref">Security Properties of Composition</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-instance-factor-patterns-if" class="internal xref">Instance Factor Patterns (IFP)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="auto internal xref">4.5.1</a>.  <a href="#name-security-benefits-by-patter" class="internal xref">Security Benefits by Pattern</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-deployment-patterns-and-exa" class="internal xref">Deployment Patterns and Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-minimal-deployment-develope" class="internal xref">Minimal Deployment: Developer Workflow (IFP Pattern C)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-production-cloud-deployment" class="internal xref">Production Cloud Deployment (IFP Pattern B)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-high-assurance-multi-cloud-" class="internal xref">High-Assurance Multi-Cloud Portable Identity (Hybrid IFP A + B)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-integration-with-existing-f" class="internal xref">Integration with Existing Frameworks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-relationship-with-other-rat" class="internal xref">Relationship with other RATS initiatives</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-alignment-with-proposed-sea" class="internal xref">Alignment with Proposed SEAT Working Group</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-the-spiffe-spire-framework" class="internal xref">The SPIFFE/SPIRE Framework</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-eca-in-a-wimse-architecture" class="internal xref">ECA in a WIMSE Architecture</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-brski-bootstrapping-remote-" class="internal xref">BRSKI (Bootstrapping Remote Secure Key Infrastructure)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-protocol-requirements-norma" class="internal xref">Protocol Requirements (Normative)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-identity-bootstrap-specific" class="internal xref">Identity Bootstrap Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-validation-gates" class="internal xref">Validation Gates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-phase-1-appraisal-gates-boo" class="internal xref">Phase 1 Appraisal Gates (Bootstrap)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-phase-3-appraisal-gates-boo" class="internal xref">Phase 3 Appraisal Gates (Bootstrap)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-phase-1-authenticated-chann" class="internal xref">Phase 1: Authenticated Channel Setup</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-phase-2-challenge-and-valid" class="internal xref">Phase 2: Challenge and Validator Factor Release</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-phase-3-joint-possession-pr" class="internal xref">Phase 3: Joint Possession Proof</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-protocol-states" class="internal xref">Protocol States</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-state-transitions" class="internal xref">State Transitions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-attestation-renewal-specifi" class="internal xref">Attestation Renewal Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-prerequisites" class="internal xref">Prerequisites</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-generic-attestation-renewal" class="internal xref">Generic Attestation Renewal Pattern</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#section-10.2.1" class="auto internal xref">10.2.1</a>.  <a href="#name-validation-gates-2" class="internal xref">Validation Gates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#section-10.2.2" class="auto internal xref">10.2.2</a>.  <a href="#name-transport-specific-implemen" class="internal xref">Transport-Specific Implementations</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-post-attestation-patterns" class="internal xref">Post-Attestation Patterns</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-security-analysis-scope" class="internal xref">Security Analysis Scope</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-identity-bootstrap-procedure" class="internal xref">Identity Bootstrap Procedure Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-attestation-renewal-securit" class="internal xref">Attestation Renewal Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-impersonation-risk" class="internal xref">Impersonation Risk</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-enforcing-factor-structure" class="internal xref">Enforcing Factor Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref">12.6</a>.  <a href="#name-threat-models" class="internal xref">Threat Models</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#section-12.7" class="auto internal xref">12.7</a>.  <a href="#name-attester-state-compromise" class="internal xref">Attester State Compromise</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.8">
                <p id="section-toc.1-1.12.2.8.1"><a href="#section-12.8" class="auto internal xref">12.8</a>.  <a href="#name-verifier-key-compromise-imp" class="internal xref">Verifier Key Compromise Impact Analysis</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.9">
                <p id="section-toc.1-1.12.2.9.1"><a href="#section-12.9" class="auto internal xref">12.9</a>.  <a href="#name-key-management-requirements" class="internal xref">Key Management Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.9.2.1">
                    <p id="section-toc.1-1.12.2.9.2.1.1"><a href="#section-12.9.1" class="auto internal xref">12.9.1</a>.  <a href="#name-ephemeral-procedure-keys" class="internal xref">Ephemeral Procedure Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.9.2.2">
                    <p id="section-toc.1-1.12.2.9.2.2.1"><a href="#section-12.9.2" class="auto internal xref">12.9.2</a>.  <a href="#name-long-term-identity-keys" class="internal xref">Long-term Identity Keys</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="auto internal xref">17.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="auto internal xref">17.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-preliminary-formal-modellin" class="internal xref">Preliminary Formal Modelling (Informative)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-core-security-properties-bo" class="internal xref">Core Security Properties (Bootstrap)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-core-security-properties-at" class="internal xref">Core Security Properties (Attestation Renewal)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3">
                <p id="section-toc.1-1.18.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-boundary-analysis-advanced-" class="internal xref">Boundary Analysis (Advanced Threat Models)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.1">
                    <p id="section-toc.1-1.18.2.3.2.1.1"><a href="#appendix-A.3.1" class="auto internal xref">A.3.1</a>.  <a href="#name-key-compromise-impersonatio" class="internal xref">Key Compromise Impersonation (KCI)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.2">
                    <p id="section-toc.1-1.18.2.3.2.2.1"><a href="#appendix-A.3.2" class="auto internal xref">A.3.2</a>.  <a href="#name-verifier-key-compromise" class="internal xref">Verifier Key Compromise</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.3">
                    <p id="section-toc.1-1.18.2.3.2.3.1"><a href="#appendix-A.3.3" class="auto internal xref">A.3.3</a>.  <a href="#name-attester-state-reveal" class="internal xref">Attester State Reveal</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-normative-eca-v1-profiles" class="internal xref">Normative ECA-V1 Profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-proof-of-possession-constru" class="internal xref">Proof-of-Possession Construction (Bootstrap)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-eca-vm-bootstrap-v1-mti-pro" class="internal xref">ECA-VM-BOOTSTRAP-V1 MTI Profile</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-primitives" class="internal xref">Primitives</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-integrity-hash-beacon-ihb" class="internal xref">Integrity Hash Beacon (IHB)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.3">
                <p id="section-toc.1-1.20.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-deterministic-key-material" class="internal xref">Deterministic Key Material</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.4">
                <p id="section-toc.1-1.20.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-phase-artifacts" class="internal xref">Phase Artifacts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.4.2.1">
                    <p id="section-toc.1-1.20.2.4.2.1.1"><a href="#appendix-C.4.1" class="auto internal xref">C.4.1</a>.  <a href="#name-phase-1-payload-attesterrep" class="internal xref">Phase 1 Payload (Attester→Repo)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.4.2.2">
                    <p id="section-toc.1-1.20.2.4.2.2.1"><a href="#appendix-C.4.2" class="auto internal xref">C.4.2</a>.  <a href="#name-phase-2-payload-verifier-re" class="internal xref">Phase 2 Payload (Verifier -&gt; Repo)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.4.2.3">
                    <p id="section-toc.1-1.20.2.4.2.3.1"><a href="#appendix-C.4.3" class="auto internal xref">C.4.3</a>.  <a href="#name-phase-3-payload-attester-re" class="internal xref">Phase 3 Payload (Attester -&gt; Repo)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.5">
                <p id="section-toc.1-1.20.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-verification-verifier" class="internal xref">Verification (Verifier)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.6">
                <p id="section-toc.1-1.20.2.6.1"><a href="#appendix-C.6" class="auto internal xref">C.6</a>.  <a href="#name-interop-notes" class="internal xref">Interop Notes</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-concrete-example-continuous" class="internal xref">Concrete Example: Continuous TEE Attestation over (D)TLS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.1">
                <p id="section-toc.1-1.21.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-scenario" class="internal xref">Scenario</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2">
                <p id="section-toc.1-1.21.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-message-flow" class="internal xref">Message Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.3">
                <p id="section-toc.1-1.21.2.3.1"><a href="#appendix-D.3" class="auto internal xref">D.3</a>.  <a href="#name-validation-details" class="internal xref">Validation Details</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-eat-profiles" class="internal xref">EAT profiles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.1">
                <p id="section-toc.1-1.22.2.1.1"><a href="#appendix-E.1" class="auto internal xref">E.1</a>.  <a href="#name-evidence-claims" class="internal xref">Evidence Claims</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.2">
                <p id="section-toc.1-1.22.2.2.1"><a href="#appendix-E.2" class="auto internal xref">E.2</a>.  <a href="#name-attestation-results" class="internal xref">Attestation Results</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-F" class="auto internal xref">Appendix F</a>.  <a href="#name-eca-sae-error-codes-registr" class="internal xref">ECA/SAE Error Codes Registry</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#appendix-G" class="auto internal xref">Appendix G</a>.  <a href="#name-change-log" class="internal xref">Change log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1">
                <p id="section-toc.1-1.24.2.1.1"><a href="#appendix-G.1" class="auto internal xref">G.1</a>.  <a href="#name-changes-since-00" class="internal xref">Changes since -00</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1.2.1">
                    <p id="section-toc.1-1.24.2.1.2.1.1"><a href="#appendix-G.1.1" class="auto internal xref">G.1.1</a>.  <a href="#name-major-architectural-changes" class="internal xref">Major Architectural Changes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1.2.2">
                    <p id="section-toc.1-1.24.2.1.2.2.1"><a href="#appendix-G.1.2" class="auto internal xref">G.1.2</a>.  <a href="#name-scope-and-terminology-refin" class="internal xref">Scope and Terminology Refinements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1.2.3">
                    <p id="section-toc.1-1.24.2.1.2.3.1"><a href="#appendix-G.1.3" class="auto internal xref">G.1.3</a>.  <a href="#name-expanded-integration-and-us" class="internal xref">Expanded Integration and Use Cases</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1.2.4">
                    <p id="section-toc.1-1.24.2.1.2.4.1"><a href="#appendix-G.1.4" class="auto internal xref">G.1.4</a>.  <a href="#name-editorial-changes" class="internal xref">Editorial Changes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2">
                <p id="section-toc.1-1.24.2.2.1"><a href="#appendix-G.2" class="auto internal xref">G.2</a>.  <a href="#name-protocol-refinement" class="internal xref">Protocol Refinement</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#appendix-H" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="motivation-and-use-cases">
<section id="section-1">
      <h2 id="name-motivation-and-use-cases">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-motivation-and-use-cases" class="section-name selfRef">Motivation and Use Cases</a>
      </h2>
<p id="section-1-1">Modern computing infrastructure often bootstraps workload identity using bearer credentials, such as API keys, join tokens, or secrets injected during initialization. While operationally simple, this model's security properties degrade as the number of workloads increases.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">If a single workload has an independent probability p of its bootstrap credential being compromised, the probability of at least one compromise occurring across a fleet of N workloads is <code>1-(1-p)^N</code>. As <code>N</code> grows, this probability approaches certainty. For example, a platform provisioning 1,000 instances per hour presents 24,000 independent opportunities for credential interception daily. A single compromised bearer token can enable persistent impersonation until the event is detected and the credential revoked.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Concurrently, high-assurance workloads, particularly those in Trusted Execution Environments (TEEs), require not only initial authentication but also continuous verification of their state. A point-in-time check is insufficient to detect compromises that may occur mid-session, creating a need for ongoing, stateful attestation that is cryptographically bound to the active communication channel.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document specifies Entity and Compute Attestation (ECA), which addresses this architectural limitation. ECA replaces a reliance on secret possession with interactive, cryptographic proof of a workload's identity and state. This approach provides security guarantees that remain constant per-instance, regardless of fleet size. ECA does not define new cryptographic primitives. Instead, it specifies a protocol that orchestrates standardized RATS architecture <span>[<a href="#RFC9334" class="cite xref">RFC9334</a>]</span>, Entity Attestation Token (EAT) <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span> and IETF-defined cryptography (HPKE <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>, Ed25519 <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>) to implement a secure Challenge/Response interaction model <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">ECA has two distinct cryptographic attestation procedures to address each specific concern:<a href="#section-1-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-6">
<li id="section-1-6.1">
          <p id="section-1-6.1.1"><strong>Identity Bootstrap procedure</strong> - For initial "cold start" establishment of verifiable identity in environments not yet provisioned. This profile is a concrete instantiations of the Challenge/Response model and provides a comprehensive replacement to the bearer-token model.<a href="#section-1-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-1-6.2">
          <p id="section-1-6.2.1"><strong>Attestation Renewal procedure</strong> - A lightweight, single round-trip attestation procedure for continuous verification of established identity and state, ideal for long-running workloads and TEEs.<a href="#section-1-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<div id="architectural-boundary-multi-cloud-and-heterogeneous-environments">
<section id="section-1.1">
        <h3 id="name-architectural-boundary-mult">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-architectural-boundary-mult" class="section-name selfRef">Architectural Boundary: Multi-Cloud and Heterogeneous Environments</a>
        </h3>
<p id="section-1.1-1">The limitations of bearer token bootstrapping are most evident in multi-cloud and bare-metal environments where provider-native identity mechanisms are unavailable. When workloads migrate between trust domains, operators often revert to provisioning static credentials, directly exposing the system to the scaling risks described previously.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">ECA's identity bootstrap procedure derives a portable and verifiable identity that survives migration across trust domains.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.1-3">
<pre>+--------------------------------------+
|  Workloads Across Environments       |
| (AWS | Azure | Bare-Metal | Edge)    |
+--------------------------------------+
                   |
                   v
         +--------------------+
         | Attestation        |
         |(Portable Identity) |
         +--------------------+
                   |
                   v
    +-----------------------------+
    | Identity Systems            |
    | (CA, SPIFFE/SPIRE, IAM) )   |
    +-----------------------------+
</pre><a href="#section-1.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="architectural-flaw-the-provisioning-race-condition">
<section id="section-1.2">
        <h3 id="name-architectural-flaw-the-prov">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-architectural-flaw-the-prov" class="section-name selfRef">Architectural Flaw: The Provisioning Race Condition</a>
        </h3>
<p id="section-1.2-1">In environments without a built-in identity provider, bootstrapping with a static secret creates a race condition: the first entity to present the secret is granted access. This model depends entirely on the operational security of the secret distribution path rather than on a verifiable property of the workload itself.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">ECA's identity bootstrap procedure generates cryptographic proof of identity that can be challenged or verified before credential release.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.2-3">
<pre>+--------------------------------------+
|  Bare-Metal / Alt-Cloud Environments |
| (No provider-backed identity)        |
+--------------------------------------+
                   |
                   v
         +--------------------+
         | Attestation        |
         | (Identity Proof)   |
         +--------------------+
                   |
                   v
    +-----------------------------+
    | Identity Consumers          |
    | (IAM, KMS, Access Control)  |
    +-----------------------------+
</pre><a href="#section-1.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="continuous-tee-verification">
<section id="section-1.3">
        <h3 id="name-continuous-tee-verification">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-continuous-tee-verification" class="section-name selfRef">Continuous TEE Verification</a>
        </h3>
<p id="section-1.3-1">In confidential computing scenarios, clients establish sessions with TEE-based services after verifying initial attestation evidence. This point-in-time verification cannot detect post-handshake compromises. An attacker who compromises the TEE mid-session can exfiltrate sensitive data while the client continues operating under stale trust assumptions.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">Continuous attestation can maintain trust throughout long-lived sessions.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.3-3">
<pre>            Verifying Relying Party          Attester
             (Client Application)       (TEE-Based Server)
                     |                           |
                     |&lt;== Established Session ==&gt;|
                     |                           |
                     |--------- Health check ---&gt;|
                     | (bound to session state)  |
                     |                           |
                     |&lt;--- Evidence -------------|
                     |(HW RoT Quote/Measurements)|
 Appraise vs. Policy |                           |
     (e.g., CoRIM    |                           |
     validation)     |------ Policy Decision ---&gt;|
                     |(upkeep or destroy session)|
</pre><a href="#section-1.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="non-goals">
<section id="section-2">
      <h2 id="name-non-goals">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-non-goals" class="section-name selfRef">Non-Goals</a>
      </h2>
<p id="section-2-1">ECA explicitly <strong>does not</strong> attempt to to provide solutions to several related but distinct concerns:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">
          <p id="section-2-2.1.1"><strong>New Cryptographic Primitives:</strong> ECA does <em>not</em> define any new cryptographic algorithms or primitives. Instead, it specifies a protocol that orchestrates the use of well-established, standardized cryptographic mechanisms like digital signatures and authenticated encryption.<a href="#section-2-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.2">
          <p id="section-2-2.2.1"><strong>Software-Based Mitigation of Hypervisor Threats:</strong> ECA does not replace the need for HRoTs where the threat model must assume a compromised service provider, hypervisor, or related platform risks.<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.3">
          <p id="section-2-2.3.1"><strong>Replacement for Single-Cloud IMDS:</strong> ECA is not intended to replace provider-native IMDS for workloads operating within a single, trusted cloud environment.<a href="#section-2-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.4">
          <p id="section-2-2.4.1"><strong>Infrastructure Trust Bootstrapping:</strong> ECA assumes operational mechanisms exist for manifest distribution, Verifier discovery, and PKI infrastructure. It integrates with existing trust foundations rather than replacing them.<a href="#section-2-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.5">
          <p id="section-2-2.5.1"><strong>Identity Framework Replacement:</strong> ECA is designed to complement systems like SPIFFE/SPIRE, for example by acting as a high-assurance node attestor.<a href="#section-2-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.6">
          <p id="section-2-2.6.1"><strong>Manufacturer Provenance:</strong> ECA handles runtime attestation and does not provide supply-chain attestation or manufacturer-anchored trust.<a href="#section-2-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-2-2.7">
          <p id="section-2-2.7.1"><strong>Streaming or Uni-Directional Attestation:</strong> ECA specifies discrete, interactive attestation procedures based on the Challenge/Response model. It does not aim to provide a protocol for the Streaming or Uni-Directional interaction models also described in <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span><a href="#section-2-2.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-3">
      <h2 id="name-conventions-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-3-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2"><strong>Attester</strong>: An entity whose trustworthiness is to be evaluated, typically combining hardware, firmware and trusted software deployed in the cloud.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3"><strong>Verifier</strong>: Conducts appraisal of Evidence to evaluate trustworthiness of the Attester, enforcing validation gates against reference values.<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3-4.1">
          <p id="section-3-4.1.1">The Verifier's appraisal relies on trust relationships with supply chain roles:<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3-4.1.2.1">
              <strong>Endorsers</strong> (e.g., hardware manufacturers) provide cryptographic identity<a href="#section-3-4.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3-4.1.2.2">
              <strong>Reference Value Providers</strong> supply expected measurements for appraisal<a href="#section-3-4.1.2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3-4.1.2.3">
              <strong>Identity Suppliers</strong> establish the Attester's cryptographic identity<a href="#section-3-4.1.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-3-5"><strong>Relying Party</strong>: Consumes signed Attestation Results to make authorization decisions.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6"><strong>Verifying Relying Party (VRP):</strong> An entity that fulfills the roles of both Verifier and Relying Party, particularly in attestation renewal procedures. The VRP directly appraises Evidence from an Attester to make an authorization decision without consulting an external Verifier.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7"><strong>Identity Supplier:</strong> In the context of ECA, this role is collaboratively fulfilled by the Attester and Verifier. The identity is not provisioned by a central authority but <em>emerges deterministically</em> from the identity bootstrap procedure, where the Attester generates its identity claims based on its inherent properties (<code>IF</code>) and the Verifier cryptographically ratifies them by issuing a signed Attestation Result.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8"><strong>Evidence:</strong> A set of claims produced by an Attester about its state, cryptographically signed by the Attester itself. In ECA, this typically takes the form of a signed EAT containing claims such as the EUID, IHB, and Proof-of-Possession.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9"><strong>Entity Attestation Token (EAT):</strong> A standardized token format <span>[<a href="#RFC9711" class="cite xref">RFC9711</a>]</span> used to convey attestation evidence in a cryptographically verifiable form.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10"><strong>Attestation Result (AR):</strong> A signed statement from a Verifier asserting the outcome of the appraisal of an Attester's Evidence. In ECA, this is a separate artifact from the Evidence, signed by the Verifier's long-term identity key.<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11"><strong>Handle:</strong> In ECA, the <code>Handle</code> as defined in [I-D.ietf-rats-reference-interaction-models] is realized through the combination of a public Binding Factor and a Verifier-supplied freshness value (e.g., a nonce or session context), eliminating the need for a trusted third-party Handle Distributor.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12"><strong>Binding Factor (BF):</strong> Scopes an attestation procedure to a specific context. In ECA procedures, the <code>BF</code>, in combination with a Verifier-issued nonce or session context, collectively serves as the Handle for the interaction. The <code>BF</code> does not require confidentiality; protocol security relies on its binding to the Instance Factor, not secrecy.<a href="#section-3-12" class="pilcrow">¶</a></p>
<p id="section-3-13"><strong>Instance Factor (IF):</strong> Platform Evidence. An inherent, measurable property of the instance that is verifiable by the Verifier. The <code>IF</code> value itself is confidential and MUST never be transmitted directly; instead, the Attester proves possession through cryptographic means (e.g., signature, quote, attestation report).<a href="#section-3-13" class="pilcrow">¶</a></p>
<p id="section-3-14"><strong>Validator Factor (VF):</strong> A secret, ephemeral challenge generated and released by the Verifier during <em>identity bootstrap procedures</em> after successful initial authentication of <code>BF</code>+<code>IF</code> possession. The <code>VF</code> MUST be bound to the <code>IF</code> (e.g., <code>VF = SHA-256(seed || IF)</code>) to mitigate against session confusion attacks.<a href="#section-3-14" class="pilcrow">¶</a></p>
<p id="section-3-15"><strong>Renewal Factor (RF):</strong> A cryptographic credential proving identity continuity. Following a full ECA identity lifecycle, <code>RF</code> is the signed <em>Attestation Result (AR)</em> issued by a Verifier from a prior bootstrap or renewal procedure. It is presented by an Attester as proof of an established identity.<a href="#section-3-15" class="pilcrow">¶</a></p>
<p id="section-3-16"><strong>Instance Factor Pattern (IFP):</strong> The set of defined methods for sourcing the private value for Instance Factor (<code>IF</code>). Three patterns are defined: hardware-rooted (Pattern A), orchestrator-provisioned (Pattern B), and artifact-based (Pattern C). For detailed specifications, see <span><a href="#instance-factor-patterns-ifp">#instance-factor-patterns-ifp</a></span>.<a href="#section-3-16" class="pilcrow">¶</a></p>
<p id="section-3-17"><strong>Joint Factor Possession:</strong> The cryptographic property where security derives from proving knowledge of multiple factors (<code>BF</code>+<code>VF</code> for bootstrap, <code>BF</code>+<code>RF</code>+<code>IF</code> for attestation renewal) rather than secrecy of individual components.<a href="#section-3-17" class="pilcrow">¶</a></p>
<p id="section-3-18"><strong>Integrity Hash Beacon (IHB):</strong> A SHA-256 binding of <code>BF</code> to <code>IF</code> that enables exposure-tolerant authentication while preventing pre-computation attacks to mitigate MiTM threats.<a href="#section-3-18" class="pilcrow">¶</a></p>
<p id="section-3-19"><strong>Exchange Identifier (eca_uuid):</strong> A unique identifier for each attestation lifecycle instance, used to construct artifact repository paths.<a href="#section-3-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conceptual-model">
<section id="section-4">
      <h2 id="name-conceptual-model-informatio">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-conceptual-model-informatio" class="section-name selfRef">Conceptual Model (Informational)</a>
      </h2>
<p id="section-4-1">The ECA protocol defines a unified pattern for the complete attestation lifecycle through two distinct but related procedures. A compute instance progresses from having no verifiable identity through initial bootstrap to ongoing health verification, establishing a continuous chain of trust.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="eca-protocol-factors-reference-table">
<section id="section-4.1">
        <h3 id="name-eca-protocol-factors-refere">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-eca-protocol-factors-refere" class="section-name selfRef">ECA Protocol Factors Reference Table</a>
        </h3>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Abbreviation</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Security Property</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Binding Factor</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>BF</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Context that scopes attestation</td>
              <td class="text-left" rowspan="1" colspan="1">Public, no secrecy required)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Instance Factor</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>IF</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Platform evidence proving instance identity</td>
              <td class="text-left" rowspan="1" colspan="1">Confidential, only transmitted out-of-band</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Validator Factor</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>VF</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Ephemeral challenge from Verifier after successful BF+IF proof</td>
              <td class="text-left" rowspan="1" colspan="1">Secret, encrypted delivery</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Renewal Factor</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>RF</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Prior attestation result used for identity continuity in renewal procedures</td>
              <td class="text-left" rowspan="1" colspan="1">Signed, verifiable credential</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="attestation-lifecycle">
<section id="section-4.2">
        <h3 id="name-attestation-lifecycle">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-attestation-lifecycle" class="section-name selfRef">Attestation Lifecycle</a>
        </h3>
<p id="section-4.2-1">The ECA protocol operates through two complementary procedures that form a complete identity lifecycle:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-2">
<pre>+----------------+   +--------------------+   +---------------------+
|                |   |                    |   |                     |
|  No Verifiable |--&gt;| Identity Bootstrap |--&gt;| Initial Attestation |
|   Identity     |   |Prove(BF + IF + VF) |   |    Result (AR)      |
|                |   |                    |   |                     |
+----------------+   +--------------------+   +---------------------+
                                                     |
                                                     | AR used as
                                                     | identity proof
                                     success         | for renewal (RF)
                                   +----&gt;-----+      |
                                   |          |      v
+-----------+      +---------------^--+    +--v------------------+
|           |fails?|                   |   |                     |
| Identity  |&lt;-----| Dynamic challenge |&lt;--| Renewal Procedure   |
| Revoked   |      |                   |   | Prove(BF + RF + IF) |
|           |      |                   |   |                     |
+-----------+      +-------------------+   +---------------------+
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<div id="identity-bootstrap-procedure">
<section id="section-4.2.1">
          <h4 id="name-identity-bootstrap-procedur">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-identity-bootstrap-procedur" class="section-name selfRef">Identity Bootstrap Procedure</a>
          </h4>
<p id="section-4.2.1-1">For instances starting without any verifiable identity ("cold start"), this three-phase procedure establishes initial trust through cryptographic proof of platform properties and context.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>Phase 1: Prove(BF + IF) → Get encrypted VF
Phase 3: Prove(BF + VF) → Derive final identity key
Output: AR (becomes RF for future renewals)
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="attestation-renewal-procedure">
<section id="section-4.2.2">
          <h4 id="name-attestation-renewal-procedu">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-attestation-renewal-procedu" class="section-name selfRef">Attestation Renewal Procedure</a>
          </h4>
<p id="section-4.2.2-1">For instances with established identity, this lightweight single-phase procedure enables continuous verification of identity and state, ideal for long-running workloads and confidential computing.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-2">
<pre>Single Phase: Prove(BF + RF + IF) → Get updated AR
Where: RF = prior AR proving identity continuity
</pre><a href="#section-4.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="credential-lifecycle">
<section id="section-4.3">
        <h3 id="name-credential-lifecycle-progre">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-credential-lifecycle-progre" class="section-name selfRef">Credential Lifecycle Progression</a>
        </h3>
<p id="section-4.3-1">A successful identity bootstrap procedure produces an Attestation Result (AR) containing the instance's verified claims. In subsequent interactions, this <code>AR</code> serves as the Renewal Factor (RF), enabling efficient re-attestation without repeating the full bootstrap.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.3-2">
<li id="section-4.3-2.1">
            <strong>Day 0: Bootstrap</strong> - Instance performs full identity bootstrap, receiving initial signed AR<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.2">
            <strong>Transition</strong> - Instance uses AR to establish secure connections to services<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.3">
            <strong>Operational</strong> - Services periodically challenge instance using attestation renewal<a href="#section-4.3-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.4">
            <strong>Renewal</strong> - Before credential expiration, instance performs attestation renewal for updated AR<a href="#section-4.3-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.5">
            <strong>End-of-Life</strong> - Instance termination or credential revocation concludes lifecycle<a href="#section-4.3-2.5" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="key-cryptographic-properties">
<section id="section-4.4">
        <h3 id="name-key-cryptographic-propertie">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-key-cryptographic-propertie" class="section-name selfRef">Key Cryptographic Properties</a>
        </h3>
<div id="factor-independence">
<section id="section-4.4.1">
          <h4 id="name-factor-independence">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-factor-independence" class="section-name selfRef">Factor Independence</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-4.4.1-1.1">Compromising BF reveals nothing about <code>IF</code>/<code>VF</code>/<code>RF</code><a href="#section-4.4.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.4.1-1.2">Compromising IF doesn't help forge <code>VF</code> or <code>RF</code> proofs<br><a href="#section-4.4.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.4.1-1.3">Each factor maintains its security properties<a href="#section-4.4.1-1.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="progressive-trust">
<section id="section-4.4.2">
          <h4 id="name-progressive-trust">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-progressive-trust" class="section-name selfRef">Progressive Trust</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-4.4.2-1.1">Phase 1: Trust from platform evidence (<code>IF</code>)<a href="#section-4.4.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.4.2-1.2">Phase 2: Trust from Verifier challenge (<code>VF</code>)<a href="#section-4.4.2-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.4.2-1.3">Phase 3: Trust from combined proof (<code>BF</code>+<code>VF</code>)<a href="#section-4.4.2-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.4.2-1.4">Renewal: Trust from continuity (<code>RF</code>) + current state (<code>IF</code>)<a href="#section-4.4.2-1.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="exposure-tolerance">
<section id="section-4.4.3">
          <h4 id="name-exposure-tolerance">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-exposure-tolerance" class="section-name selfRef">Exposure Tolerance</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-4.4.3-1.1">
              <code>BF</code> is public by design<a href="#section-4.4.3-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.4.3-1.2">Security comes from binding, not secrecy<a href="#section-4.4.3-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.4.3-1.3">Even if attacker knows <code>BF</code>, they cannot forge proofs without other factors<a href="#section-4.4.3-1.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="security-properties-of-composition">
<section id="section-4.4.4">
          <h4 id="name-security-properties-of-comp">
<a href="#section-4.4.4" class="section-number selfRef">4.4.4. </a><a href="#name-security-properties-of-comp" class="section-name selfRef">Security Properties of Composition</a>
          </h4>
<p id="section-4.4.4-1">ECA allows operators to derive instance identity algebraically.<a href="#section-4.4.4-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Composition</th>
                <th class="text-left" rowspan="1" colspan="1">Security Property</th>
                <th class="text-left" rowspan="1" colspan="1">Threat Mitigated</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>BF + IF</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">Proof of platform identity</td>
                <td class="text-left" rowspan="1" colspan="1">Prevents impersonation</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>BF + VF</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">Proof of challenge receipt</td>
                <td class="text-left" rowspan="1" colspan="1">Prevents session confusion</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <strong>BF + RF + IF</strong>
</td>
                <td class="text-left" rowspan="1" colspan="1">Continuous verification</td>
                <td class="text-left" rowspan="1" colspan="1">Detects runtime compromise</td>
              </tr>
            </tbody>
          </table>
<p id="section-4.4.4-3">This factor algebra enables <em>composable trust</em> across diverse services that adapts to available evidence sources while maintaining strong security guarantees.<a href="#section-4.4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="instance-factor-patterns-ifp">
<section id="section-4.5">
        <h3 id="name-instance-factor-patterns-if">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-instance-factor-patterns-if" class="section-name selfRef">Instance Factor Patterns (IFP)</a>
        </h3>
<p id="section-4.5-1">The Instance Factor (IF) can be sourced through three defined patterns, each addressing different threat models.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Pattern</th>
              <th class="text-left" rowspan="1" colspan="1">Security Foundation</th>
              <th class="text-left" rowspan="1" colspan="1">Threat Model</th>
              <th class="text-left" rowspan="1" colspan="1">Typical Environments</th>
              <th class="text-left" rowspan="1" colspan="1">Example IF Sources</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>A: Hardware-Rooted</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Hardware Root of Trust (HRoT)</td>
              <td class="text-left" rowspan="1" colspan="1">Malicious provider, compromised hypervisor</td>
              <td class="text-left" rowspan="1" colspan="1">Confidential computing, zero-trust, regulated workloads</td>
              <td class="text-left" rowspan="1" colspan="1">TPM seated secret, TEE-derived key, secure enclave measurement, described in a format such as CoRIM <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>B: Orchestrator-Provisioned</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Trusted control plane</td>
              <td class="text-left" rowspan="1" colspan="1">Network attackers, untrusted workload</td>
              <td class="text-left" rowspan="1" colspan="1">Cloud-native, Kubernetes, managed services</td>
              <td class="text-left" rowspan="1" colspan="1">Instance metadata token, Kubernetes secret, etc. An ideal format for such claims is the Measurement or Policy Set (mps) claim defined in <span>[<a href="#I-D.ietf-rats-posture-assessment" class="cite xref">I-D.ietf-rats-posture-assessment</a>]</span> such as a CIS Benchmark.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>C: Artifact-Based</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Artifact integrity</td>
              <td class="text-left" rowspan="1" colspan="1">Mitigating Trust-on-first-use (TOFU) scenarios</td>
              <td class="text-left" rowspan="1" colspan="1">Development, testing, constrained environments</td>
              <td class="text-left" rowspan="1" colspan="1">File content hash, container filesystem measurement, authorized_keys</td>
            </tr>
          </tbody>
        </table>
<div id="security-benefits-by-pattern">
<section id="section-4.5.1">
          <h4 id="name-security-benefits-by-patter">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-security-benefits-by-patter" class="section-name selfRef">Security Benefits by Pattern</a>
          </h4>
<p id="section-4.5.1-1">The ECA protocol is designed to provide strong security guarantees, including an authentication property (which is undergoing preliminary formal analysis) to prevent impersonation as well as a check for <em>freshness</em> that prevents replay attacks.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<div id="pattern-a-hardware-rooted">
<section id="section-4.5.1.1">
            <h5 id="name-pattern-a-hardware-rooted">
<a href="#section-4.5.1.1" class="section-number selfRef">4.5.1.1. </a><a href="#name-pattern-a-hardware-rooted" class="section-name selfRef">Pattern A: Hardware-Rooted</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-4.5.1.1-1.1">
                <p id="section-4.5.1.1-1.1.1"><strong>Foundation:</strong> Hardware Root of Trust (HRoT).<a href="#section-4.5.1.1-1.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.5.1.1-1.2">
                <p id="section-4.5.1.1-1.2.1"><strong>Primary Benefit:</strong> This pattern is designed to mitigate the threat of a <em>malicious or compromised provider</em>, including a compromised hypervisor. By anchoring the <code>IF</code> in hardware, ECA ensures that the proof of identity is not only rooted in a trusted component but is also strongly <em>proven</em> and demonstrated <em>fresh</em> for each session, preventing the replay of previously valid attestations even in a hostile environment.<a href="#section-4.5.1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="pattern-b-orchestrator-provisioned">
<section id="section-4.5.1.2">
            <h5 id="name-pattern-b-orchestrator-prov">
<a href="#section-4.5.1.2" class="section-number selfRef">4.5.1.2. </a><a href="#name-pattern-b-orchestrator-prov" class="section-name selfRef">Pattern B: Orchestrator-Provisioned</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-4.5.1.2-1.1">
                <p id="section-4.5.1.2-1.1.1"><strong>Foundation:</strong> Trust in a centralized control plane, like Kubernetes.<a href="#section-4.5.1.2-1.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.5.1.2-1.2">
                <p id="section-4.5.1.2-1.2.1"><strong>Primary Benefit:</strong> This pattern mitigates against <em>network-level attackers</em> attempting to impersonate a workload. By requiring an interactive proof, ECA ensures that the workload's identity is not only <em>demonstrated</em> via the trusted orchestrator but is also verified with a strong <em>freshness</em> signal. This interactive proof model directly mitigates the risks of a stolen bearer token being replayed, as the proof is unique to the current session and cryptographically bound to its context.<a href="#section-4.5.1.2-1.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="pattern-c-artifact-based">
<section id="section-4.5.1.3">
            <h5 id="name-pattern-c-artifact-based">
<a href="#section-4.5.1.3" class="section-number selfRef">4.5.1.3. </a><a href="#name-pattern-c-artifact-based" class="section-name selfRef">Pattern C: Artifact-Based</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-4.5.1.3-1.1">
                <p id="section-4.5.1.3-1.1.1"><strong>Foundation:</strong> The integrity of the provisioning process and the artifact itself.<a href="#section-4.5.1.3-1.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.5.1.3-1.2">
                <p id="section-4.5.1.3-1.2.1"><strong>Primary Benefit:</strong> This pattern is primarily designed to mitigate <em>Trust-on-First-Use (TOFU) vulnerabilities and race conditions</em>. By requiring an interactive proof, it guarantees that the identity is <em>demonstrated</em> for a specific context and, through its <em>freshness</em> mechanism, ensures that the proof is live and not a replay. This prevents a faster, malicious workload from hijacking the identity by replaying a captured or prematurely accessed artifact.<a href="#section-4.5.1.3-1.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="deployment-patterns">
<section id="section-5">
      <h2 id="name-deployment-patterns-and-exa">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-deployment-patterns-and-exa" class="section-name selfRef">Deployment Patterns and Examples</a>
      </h2>
<p id="section-5-1">This section illustrates practical ECA deployment across different environments and assurance levels using the defined Instance Factor Patterns (IFP).<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="minimal-deployment-developer-workflow-ifp-pattern-c">
<section id="section-5.1">
        <h3 id="name-minimal-deployment-develope">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-minimal-deployment-develope" class="section-name selfRef">Minimal Deployment: Developer Workflow (IFP Pattern C)</a>
        </h3>
<p id="section-5.1-1">This pattern demonstrates that strong, verifiable identity does not require complex infrastructure. ECA provides a high-assurance, cryptographically-bound identity with minimal prerequisites, offering security guarantees superior to bearer tokens at a fraction of the operational overhead required to deploy and manage a full identity framework in small-scale environments.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2"><strong>Scenario</strong>: Developer needs secure access to temporary cloud VMs for testing.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1-3.1">
            <strong>Binding Factor (BF):</strong> SSH public key + high entropy token<a href="#section-5.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.1-3.2">
            <strong>Instance Factor (IF):</strong> VM's assigned <code>vendor_uuid</code><a href="#section-5.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.1-3.3">
            <strong>Verifier Factor (VF):</strong> Developer's own laptop<a href="#section-5.1-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-4"><strong>Trust Model</strong>:
-  Developer trusts their local ECA toolchain CLI for <code>BF</code> generation
-  Developer trusts Service Provider to correctly inject <code>BF</code>/<code>SSH public key</code>
-  Developer trusts their laptop to keep <code>VF</code> confidential
-  VM proves possession of <code>BF</code>+<code>IF</code> to receive <code>VF</code>
-  VM proves possession of <code>BF</code>+<code>VF</code> to complete attestation
-  Developer has acceptable assurance to connect directly with VM<a href="#section-5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="production-cloud-deployment-ifp-pattern-b">
<section id="section-5.2">
        <h3 id="name-production-cloud-deployment">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-production-cloud-deployment" class="section-name selfRef">Production Cloud Deployment (IFP Pattern B)</a>
        </h3>
<p id="section-5.2-1">This pattern ends the compounding risk calculus that comes with high scale. Because each identity is established via a fresh, interactive cryptographic proof, the security guarantees remain constant whether deploying one hundred or one thousand new workloads per hour, mitigating the increased threat of credential compromise in large, dynamic environments.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2"><strong>Scenario</strong>: Containerized microservice needing identity for service mesh communication.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3"><strong>Implementation</strong>:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.2-4.1">
            <strong>Binding Factor (BF):</strong> Container image digest + service account context<a href="#section-5.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.2-4.2">
            <strong>Instance Factor (IF):</strong> Kubernetes service account token<a href="#section-5.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.2-4.3">
            <strong>Verifier Factor (VF):</strong> Ephemeral challenge from central verifier<a href="#section-5.2-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-5"><strong>Trust Model</strong>:
- Trust in cloud provider's control plane
- Protection against network attackers
- No requirement for hardware-level attestation<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6"><strong>Integration</strong>: SPIRE node attestation replacing join tokens with evidence-based enrollment.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="high-assurance-multi-cloud-portable-identity-hybrid-ifp-a-b">
<section id="section-5.3">
        <h3 id="name-high-assurance-multi-cloud-">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-high-assurance-multi-cloud-" class="section-name selfRef">High-Assurance Multi-Cloud Portable Identity (Hybrid IFP A + B)</a>
        </h3>
<p id="section-5.3-1">This pattern provides a portable identity that survives migration across trust domains without degrading security posture. ECA allows organizations to leverage the high assurance of Hardware Roots of Trust (HRoT) for Pattern A while maintaining consistent, verifiable identity for standard workloads, achieving vendor independence without reverting to less-secure bearer tokens.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2"><strong>Scenario</strong>: An organization requiring a consistent identity mechanism across a heterogeneous fleet of workloads. The fleet consists of both high-assurance, hardware-protected services and standard-assurance, software-based applications deployed across multiple cloud and on-premises environments.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3-3.1">
            <strong>High-Assurance Workloads:</strong> These workloads handle regulated data and are deployed within Trusted Execution Environments (TEEs) that provide a Hardware Root of Trust (HRoT).<a href="#section-5.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.3-3.2">
            <strong>Standard-Assurance Workloads:</strong> These include ephemeral, auto-scaling virtual machines that lack HRoTs, used for cost-sensitive tasks such as hosting a static website.<a href="#section-5.3-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-4"><strong>Implementation:</strong><a href="#section-5.3-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3-5.1">
            <strong>Binding Factor (BF):</strong> A consistent <code>BF</code> is used across the fleet, such as signed artifacts from the organization's CI/CD pipeline.<a href="#section-5.3-5.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.3-5.2">
            <p id="section-5.3-5.2.1"><strong>Instance Factor (IF):</strong> The Verifier is configured to appraise <code>IF</code>s derived from two distinct patterns:<a href="#section-5.3-5.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3-5.2.2.1">
                <p id="section-5.3-5.2.2.1.1"><strong>Pattern A (Hardware-Rooted)</strong> for high-assurance workloads:<a href="#section-5.3-5.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3-5.2.2.1.2.1">
                    <strong>On-premises:</strong> A TPM-signed quote.<a href="#section-5.3-5.2.2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-5.3-5.2.2.1.2.2">
                    <strong>AWS:</strong> A signed attestation document from a Nitro Enclave.<a href="#section-5.3-5.2.2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="compact" id="section-5.3-5.2.2.1.2.3">
                    <strong>Azure:</strong> A token validated by the Azure Attestation service.<a href="#section-5.3-5.2.2.1.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="compact" id="section-5.3-5.2.2.2">
                <p id="section-5.3-5.2.2.2.1"><strong>Pattern B (Orchestrator-Provisioned)</strong> for standard-assurance workloads:<a href="#section-5.3-5.2.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3-5.2.2.2.2.1">A short-lived, signed instance identity document from the cloud provider's metadata service.<a href="#section-5.3-5.2.2.2.2.1" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact" id="section-5.3-5.3">
            <strong>Verifier Factor (VF):</strong> The centralized organizational Verifier issues the ephemeral challenge to all workloads after successfully validating their respective <code>BF</code> + <code>IF</code> proofs.<a href="#section-5.3-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-6"><strong>Operational Considerations and Unification:</strong><a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">The ECA protocol provides a unified attestation endpoint, allowing the Verifier to act as a single point of policy enforcement. For example, the Verifier's policy engine can be configured to issue credentials with different levels of privilege based on the evidence pattern presented:<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3-8.1">A workload successfully attesting with <strong>Pattern A</strong> evidence may be granted a long-lived, high-privilege identity.<a href="#section-5.3-8.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-5.3-8.2">A workload successfully attesting with <strong>Pattern B</strong> evidence may be granted a short-lived, low-privilege identity suitable for its function.<a href="#section-5.3-8.2" class="pilcrow">¶</a>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-5.3-9">
<pre>[Verifier] (under operator control)
    ^
    |
    |---&gt; [Workload in AWS] --(proves BF+IF)--&gt; [Operator Policy]
    |
    |---&gt; [Workload in Azure] --(proves BF+IF)--&gt; [Same Policy]
    |
    |---&gt; [VM on-prem] --(proves BF+IF)--&gt; [Dedicated Policy]
</pre><a href="#section-5.3-9" class="pilcrow">¶</a>
</div>
<p id="section-5.3-10">Alternatively, when working with existing enterprise deployments where identity frameworks may already be standing such as SPIFFE/SPIRE, ECA could be used as a high-assurance node attester where an AR by a trusted Verifier can be used to to generate an SVID (see <span><a href="#the-spiffespire-framework">#the-spiffespire-framework</a></span>).<a href="#section-5.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="integration-with-existing-frameworks">
<section id="section-6">
      <h2 id="name-integration-with-existing-f">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-integration-with-existing-f" class="section-name selfRef">Integration with Existing Frameworks</a>
      </h2>
<div id="relationship-with-other-rats-initiatives">
<section id="section-6.1">
        <h3 id="name-relationship-with-other-rat">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-relationship-with-other-rat" class="section-name selfRef">Relationship with other RATS initiatives</a>
        </h3>
<p id="section-6.1-1">ECA is designed to operate within the broader RATS ecosystem and complements other key specifications.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1"><strong>RATS Interaction Models:</strong> As stated previously, ECA's procedures are direct implementations of the <strong>Challenge/Response model</strong> described in <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="cite xref">I-D.ietf-rats-reference-interaction-models</a>]</span>. It provides the normative cryptographic details and state machine for a secure, interactive attestation flow that can be used to realize patterns like the Passport Model.<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.2">
            <p id="section-6.1-2.2.1"><strong>RATS Posture Assessment:</strong> The ECA protocol provides a secure conveyance mechanism for the high-level EAT payloads defined in <span>[<a href="#I-D.ietf-rats-posture-assessment" class="cite xref">I-D.ietf-rats-posture-assessment</a>]</span>. The posture assessment draft focuses on defining claims that summarize compliance (the 'what'). ECA's Identity Bootstrap and Attestation Renewal procedures offer a purpose-built, secure protocol for conveying these posture claims (the 'how'), whose security properties are undergoing preliminary formal analysis. A successful ECA bootstrap can produce an Attestation Result that confirms an Attester's compliance with a specific <code>mps</code> claim.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-2.3">
            <p id="section-6.1-2.3.1"><strong>Evidence Abstraction and Flexibility:</strong>  Concise Reference Integrity Manifests (CoRIM) <span>[<a href="#I-D.ietf-rats-corim" class="cite xref">I-D.ietf-rats-corim</a>]</span> is designed to define the expected values for low-level hardware and software measurements. The ECA protocol is agnostic to the evidence payload and is equally capable of conveying a detailed TEE Quote intended for appraisal against a CoRIM manifest (as in <strong>IFP Pattern A</strong>) or a summarized <code>mps</code> claim (as in <strong>IFP Pattern B</strong>). This flexibility allows operators to use a single, consistent attestation protocol across different assurance requirements and levels of abstraction.<a href="#section-6.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="seat-working-group-alignment">
<section id="section-6.2">
        <h3 id="name-alignment-with-proposed-sea">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-alignment-with-proposed-sea" class="section-name selfRef">Alignment with Proposed SEAT Working Group</a>
        </h3>
<p id="section-6.2-1">This specification's <strong>attestation renewal procedure</strong> directly implements the SEAT WG charter requirements for attested (D)TLS:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">SEAT Requirement</th>
              <th class="text-left" rowspan="1" colspan="1">How ECA Satisfies</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Per-connection freshness</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>certificate_request_context</code> bound into TEE Quote</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Leverage (D)TLS 1.3</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Via RFC 9261 Exported Authenticators</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Leverage RATS formats</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">CMW, CoRIM, AR4SI, EAT</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>No core (D)TLS modifications</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Only <code>cmw_attestation</code> extension</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Mutual attestation support</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Symmetric client/server attestation procedures</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="the-spiffespire-framework">
<section id="section-6.3">
        <h3 id="name-the-spiffe-spire-framework">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-the-spiffe-spire-framework" class="section-name selfRef">The SPIFFE/SPIRE Framework</a>
        </h3>
<p id="section-6.3-1">The ECA protocol is designed to complement and enhance the SPIFFE/SPIRE framework by providing a standardized, interactive protocol for node attestation. SPIFFE/SPIRE's extensible node attestor architecture provides a clear integration path for new attestation methods, and ECA offers a mechanism specifically designed for environments where provider metadata is insufficient or unavailable.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">For environments lacking a hardware root of trust, SPIRE's primary software-based bootstrap method is the Join Token. As a bearer token, its security model relies on the confidentiality of the token during delivery; if the token is intercepted or leaked, an attacker can use it to enroll a rogue workload.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">The ECA identity bootstrap procedure presents a path for a next-generation, built-in SPIRE node attestor that operates without bearer tokens. By implementing ECA natively, the SPIRE agent could act as the ECA Attester and the SPIRE server as the ECA Verifier. This would evolve the enrollment model by replacing the dependency on "possession of a secret" with a model based on an interactive, challenge-response proof of the compute instance's identity. This approach, which uses measurable properties of the instance itself, is designed to drastically reduce the risk of impersonation.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">Beyond initial bootstrapping, the ECA <em>attestation renewal procedure</em> offers a standardized mechanism for periodic, stateful health checks. A native ECA node attestor would leverage this renewal procedure to enable SPIRE to perform continuous health verification of the node itself, beyond the initial attestation, a critical requirement for modern infrastructure.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">In this integrated model, a successful ECA bootstrap would conclude with an Attestation Result (AR) containing verifiable claims. The SPIRE server, acting as the Verifier, would validate this AR and use its claims (e.g., <code>eca_uuid</code>, EUID, <code>IHB</code>) as selectors for a secure registration policy, admitting the node to issue SVIDs as usual.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-6">
<pre># Example of SPIRE registration entry using selectors from a native ECA attestor
spire-server entry create -spiffeID "spiffe://example.org/my-service"
-parentID "spiffe://example.org/spire/agent/eca/&lt;verifier_id&gt;"
-selector "eca:euid:a1b2c3d4..."
-selector "eca:ihb:e5f6g7h8..."
</pre><a href="#section-6.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="eca-in-a-wimse-architecture">
<section id="section-6.4">
        <h3 id="name-eca-in-a-wimse-architecture">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-eca-in-a-wimse-architecture" class="section-name selfRef">ECA in a WIMSE Architecture</a>
        </h3>
<p id="section-6.4-1">The WIMSE (Workload Identity in Multi-System Environments) architecture aims to standardize how workloads obtain and use identity credentials across diverse platforms. ECA aligns with and enhances this architecture by providing a standardized, attestation-based mechanism for bootstrapping verifiable workload identity, directly addressing the bootstrapping use case identified in the WIMSE charter.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">Within the WIMSE model, ECA fulfills a critical role in the initial "Bootstrapping Workload Identifiers and Credentials" phase. The ECA <em>identity bootstrap procedure</em> allows a workload (acting as the ECA Attester) to establish its initial identity by providing cryptographic proof of its state to a service (the ECA Verifier). A successful attestation results in a signed Attestation Result (AR).<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">This AR can be integrated into the WIMSE ecosystem through several patterns:<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-4.1">
            <p id="section-6.4-4.1.1"><strong>Direct AR Presentation:</strong> The workload can present its ECA-derived AR directly to a WIMSE-protected service using attested (D)TLS, for example via the TLS Exported Authenticators mechanism with the <code>cmw_attestation</code> extension. In this model, the service acts as a Verifying Relying Party, consuming the AR directly for authentication and authorization decisions.<a href="#section-6.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-4.2">
            <p id="section-6.4-4.2.1"><strong>Token Exchange:</strong> The workload can present its AR to a WIMSE Identity Service (e.g., an OAuth Authorization Server) to exchange it for a standard WIMSE token (e.g., a JWT access token or a SPIFFE SVID). This pattern leverages the WIMSE <em>Token Exchange</em> deliverable, allowing the workload to use a normalized credential with services that may not natively process attestation results. This pattern allows legacy services that understand JWTs but not attestation results to participate in a WIMSE ecosystem without modification, while still benefiting from ECA's strong bootstrap security.<a href="#section-6.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-4.3">
            <p id="section-6.4-4.3.1"><strong>Credential Injection:</strong> The ECA Verifier can be co-located with or act as a WIMSE credential issuer. Upon successful attestation, it directly injects a short-lived identity credential (e.g., an X.509 certificate) into the workload. This pattern streamlines the bootstrap process, combining attestation and credential issuance into a single step.<a href="#section-6.4-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.4-5">By providing a cryptographically strong, platform-agnostic alternative to static secrets or provider-locked identity documents, ECA enables the portable, least-privilege identity that WIMSE envisions. It is particularly suited for environments lacking a native identity service, thereby supporting WIMSE's goal of operating across multi-cloud and heterogeneous deployments.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<p id="section-6.4-6">This integration directly supports the WIMSE charter's focus on standardizing workload identity across different platforms and its acknowledgment of attestation as a key mechanism for securing the credential bootstrapping process.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<p id="section-6.4-7">When integrating ECA into a WIMSE-compliant system, the roles map as follows:<a href="#section-6.4-7" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
          <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">ECA Role</th>
              <th class="text-left" rowspan="1" colspan="1">WIMSE Role</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Attester</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Workload</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">The ephemeral compute instance requiring identity.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Verifier</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Identity or Attestation Service</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">The entity within the trust domain that validates the workload's claims.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Relying Party</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Service Consumer or Authorization Service</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">An entity that consumes the Attestation Result to make an authorization decision.</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="brski-bootstrapping">
<section id="section-6.5">
        <h3 id="name-brski-bootstrapping-remote-">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-brski-bootstrapping-remote-" class="section-name selfRef">BRSKI (Bootstrapping Remote Secure Key Infrastructure)</a>
        </h3>
<p id="section-6.5-1">BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> and ECA are complementary. BRSKI solves manufacturer-anchored onboarding for physical devices based on supply-chain provenance. ECA targets just-in-time software and instance attestation at compute runtime. An operator could use BRSKI to enroll a physical device, and subsequently use ECA for continuous attestation of the software state on that device.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-requirements-normative">
<section id="section-7">
      <h2 id="name-protocol-requirements-norma">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-protocol-requirements-norma" class="section-name selfRef">Protocol Requirements (Normative)</a>
      </h2>
<p id="section-7-1">Implementations MUST ensure the following normative requirements are maintained regardless of the specific profile or transport:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-7-2">
<li id="section-7-2.1">
          <strong>Binding Factor Entropy:</strong> The Binding Factor (BF) MUST be a high-entropy (≥128 bits) value to ensure strong key deriviation.<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-7-2.2">
          <strong>Freshness Binding:</strong> All attestation procedures MUST be bound to a unique, non-reusable identifier.<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-7-2.3">
          <strong>Key Separation:</strong> Keys used for Phase 2 encryption MUST be distinct from Phase 3 signing keys.<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
        <li id="section-7-2.4">
          <strong>Evidence Integrity:</strong> All Evidence MUST be cryptographically bound to the attestation context.<a href="#section-7-2.4" class="pilcrow">¶</a>
</li>
        <li id="section-7-2.5">
          <strong>Factor Independence:</strong> <code>BF</code> and Instance Factor (IF) MUST be computationally independent.<a href="#section-7-2.5" class="pilcrow">¶</a>
</li>
        <li id="section-7-2.6">
          <strong>Instance Factor Structure:</strong> The Instance Factor MUST be a structured, verifiable claim about instance properties rather than random entropy. The Instance Factor SHOULD take recognizable forms such as vendor-assigned identifiers (UUIDs, instance IDs), hardware attestation outputs (TPM quotes, TEE reports), or deterministic measurements (content hashes, configuration digests). Implementations MUST NOT use randomly generated secrets as Instance Factors. This structural requirement ensures that factor independence violations during provisioning produce detectably malformed attestations.<a href="#section-7-2.6" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="protocol-overview">
<section id="section-8">
      <h2 id="name-identity-bootstrap-specific">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-identity-bootstrap-specific" class="section-name selfRef">Identity Bootstrap Specification</a>
      </h2>
<p id="section-8-1">This section provides the normative specification for the Identity Bootstrap Procedure, the detailed mechanics of which implement the conceptual lifecycle and factor model described in <span><a href="#conceptual-model">#conceptual-model</a></span>. The attestation renewal procedure is specified in <span><a href="#attestation-renewal-specification">#attestation-renewal-specification</a></span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The identity bootstrap procedure is the security-critical foundation of ECA. All preliminary formal security analysis (<span><a href="#app-formal-modelling-informative">#app-formal-modelling-informative</a></span>) applies to this procedure type. It follows a three-phase process, beginning with the Attester-free of privileged credentials, and concluding with the Verifier producing a signed Attestation Result (AR) upon successful validation.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="sec-validation-gates">
<section id="section-8.1">
        <h3 id="name-validation-gates">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-validation-gates" class="section-name selfRef">Validation Gates</a>
        </h3>
<p id="section-8.1-1">The Verifier enforces a sequence of fail-closed validation gates in a specific order derived from the protocol's preliminary formal model. Each gate represents a critical check that must pass before proceeding.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<div id="phase-1-appraisal-gates-bootstrap">
<section id="section-8.1.1">
          <h4 id="name-phase-1-appraisal-gates-boo">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-phase-1-appraisal-gates-boo" class="section-name selfRef">Phase 1 Appraisal Gates (Bootstrap)</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-8.1.1-1">
<li id="section-8.1.1-1.1">
              <p id="section-8.1.1-1.1.1"><strong>MAC Verification:</strong> Verifies the integrity of the Phase-1 payload using an HMAC tag derived from <code>BF</code> and <code>IF</code>.<a href="#section-8.1.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.1-1.1.2.1">Failure Action: Immediate termination. Publish error status <code>MAC_INVALID</code>.<a href="#section-8.1.1-1.1.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-8.1.1-1.2">
              <p id="section-8.1.1-1.2.1"><strong>Instance Authorization:</strong> Checks if the Attester's identity (e.g., derived from a unique Exchange Identifier or Instance Factor) is authorized to proceed.<a href="#section-8.1.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.1-1.2.2.1">Failure Action: Immediate termination. Publish error status <code>ID_MISMATCH</code>.<a href="#section-8.1.1-1.2.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-8.1.1-1.3">
              <p id="section-8.1.1-1.3.1"><strong>IHB Validation:</strong> Confirms that the received Integrity Hash Beacon (IHB) matches the expected value for the authorized instance.<a href="#section-8.1.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.1-1.3.2.1">Failure Action: Immediate termination. Publish error status <code>IHB_MISMATCH</code>.<a href="#section-8.1.1-1.3.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-8.1.1-1.4">
              <p id="section-8.1.1-1.4.1"><strong>KEM Public Key Match:</strong> Ensures the ephemeral encryption public key in the payload matches the expected key for the session.<a href="#section-8.1.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.1-1.4.2.1">Failure Action: Immediate termination. Publish error status <code>KEM_MISMATCH</code>.<a href="#section-8.1.1-1.4.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ol>
</section>
</div>
<div id="phase-3-appraisal-gates-bootstrap">
<section id="section-8.1.2">
          <h4 id="name-phase-3-appraisal-gates-boo">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-phase-3-appraisal-gates-boo" class="section-name selfRef">Phase 3 Appraisal Gates (Bootstrap)</a>
          </h4>
<ol start="5" type="1" class="normal type-1" id="section-8.1.2-1">
<li id="section-8.1.2-1.1">
              <p id="section-8.1.2-1.1.1"><strong>Evidence Time Window:</strong> Validates that the <code>iat</code>, <code>nbf</code>, and <code>exp</code> claims in the final EAT are within an acceptable time skew (e.g., ±60 seconds).<a href="#section-8.1.2-1.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.2-1.1.2.1">Failure Action: Immediate termination. Publish error status <code>TIME_EXPIRED</code>.<a href="#section-8.1.2-1.1.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-8.1.2-1.2">
              <p id="section-8.1.2-1.2.1"><strong>EAT Schema Compliance:</strong> Checks that the EAT contains all required claims with the correct types and encodings.<a href="#section-8.1.2-1.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.2-1.2.2.1">Failure Action: Immediate termination. Publish error status <code>SCHEMA_ERROR</code>.<a href="#section-8.1.2-1.2.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-8.1.2-1.3">
              <p id="section-8.1.2-1.3.1"><strong>EAT Signature:</strong> Verifies the Ed25519 signature on the EAT using the public key derived from <code>BF</code> and <code>VF</code>.<a href="#section-8.1.2-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.2-1.3.2.1">Failure Action: Immediate termination. Publish error status <code>SIG_INVALID</code>.<a href="#section-8.1.2-1.3.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-8.1.2-1.4">
              <p id="section-8.1.2-1.4.1"><strong>Nonce Match:</strong> Ensures the nonce in the EAT matches the nonce the Verifier issued in Phase 2, proving freshness.<a href="#section-8.1.2-1.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.2-1.4.2.1">Failure Action: Immediate termination. Publish error status <code>NONCE_MISMATCH</code>.<a href="#section-8.1.2-1.4.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-8.1.2-1.5">
              <p id="section-8.1.2-1.5.1"><strong>Binding Proof (PoP) Validation:</strong> Verifies single proof covering factor possession, key binding, and freshness<a href="#section-8.1.2-1.5.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.1.2-1.5.2.1">Failure Action: Immediate termination. Publish error status <code>POP_INVALID</code>.<a href="#section-8.1.2-1.5.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="phase-1-authenticated-channel-setup">
<section id="section-8.2">
        <h3 id="name-phase-1-authenticated-chann">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-phase-1-authenticated-chann" class="section-name selfRef">Phase 1: Authenticated Channel Setup</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-8.2-1.1">
            <strong>Attester</strong> generates an ephemeral X25519 keypair deterministically from <code>BF</code> + <code>IF</code>.<a href="#section-8.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-1.2">Computes the Integrity Hash Beacon (IHB): <code>IHB = SHA-256(BF || IF)</code>.<a href="#section-8.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-1.3">Publishes a CBOR payload containing <code>{kem_pub, ihb}</code> and an associated HMAC tag to the repository.<a href="#section-8.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.2-1.4">
            <strong>Verifier</strong> retrieves the published artifacts and validates them against Gates 1-4.<a href="#section-8.2-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="phase-2-challenge-and-validator-factor-release">
<section id="section-8.3">
        <h3 id="name-phase-2-challenge-and-valid">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-phase-2-challenge-and-valid" class="section-name selfRef">Phase 2: Challenge and Validator Factor Release</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-8.3-1.1">
            <p id="section-8.3-1.1.1"><strong>Verifier</strong> generates:<a href="#section-8.3-1.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8.3-1.1.2.1">A fresh <code>VF</code> (≥128 bits)<a href="#section-8.3-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.3-1.1.2.2">A 16-byte nonce<a href="#section-8.3-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-8.3-1.1.2.3">A fresh ephemeral Ed25519 keypair for this specific bootstrap procedure<a href="#section-8.3-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="compact" id="section-8.3-1.2">Encrypts <code>{VF, nonce}</code> using HPKE to the Attester's ephemeral public key<a href="#section-8.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-1.3">Signs the encrypted payload with the ephemeral procedure key (the Verifier's long-term identity key MUST NOT be used)<a href="#section-8.3-1.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-1.4">Publishes the signed payload and the ephemeral public key to the repository<a href="#section-8.3-1.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.3-1.5">
            <strong>Attester</strong> retrieves the published payload, verifies the signature using the published ephemeral public key, and decrypts the <code>VF</code><a href="#section-8.3-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="phase-3-joint-possession-proof">
<section id="section-8.4">
        <h3 id="name-phase-3-joint-possession-pr">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-phase-3-joint-possession-pr" class="section-name selfRef">Phase 3: Joint Possession Proof</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-8.4-1.1">
            <strong>Attester</strong> derives a final Ed25519 signing keypair deterministically from <code>BF</code>+<code>VF</code>.<a href="#section-8.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.4-1.2">Creates a signed EAT containing identity claims, the Verifier's nonce, and a final <code>pop_tag</code>. The <code>pop_tag</code> proves knowledge of the secret VF without revealing it while binding it to the procedure context.<a href="#section-8.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.4-1.3">Publishes the signed EAT to the repository.<a href="#section-8.4-1.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-8.4-1.4">
            <strong>Verifier</strong> retrieves the final EAT and validates the <strong>Evidence EAT</strong> against Gates 5-11. Upon success, the Verifier generates and signs a separate <strong>Attestation Result (AR)</strong>, which cryptographically confirms the validity of the claims made in the Evidence.<a href="#section-8.4-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-states">
<section id="section-9">
      <h2 id="name-protocol-states">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-protocol-states" class="section-name selfRef">Protocol States</a>
      </h2>
<p id="section-9-1">These states apply to the identity bootstrap procedure; see []{#attestation-renewal-specification} for renewal.<a href="#section-9-1" class="pilcrow">¶</a></p>
<table class="center" id="table-6">
        <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">State</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>INIT</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">New attestation lifecycle initiated.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>AWAITING_ATTESTER_PROOF</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Awaiting Phase 1 artifacts.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>PROVING_TO_ATTESTER</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Publishing Phase 2 artifacts.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>AWAITING_EVIDENCE</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Awaiting Phase 3 artifacts.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>VALIDATING</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Appraisal of evidence.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>SUCCESS</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Terminal success state.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>FAIL</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">Terminal failure state.</td>
          </tr>
        </tbody>
      </table>
<div id="sec-state-transitions">
<section id="section-9.1">
        <h3 id="name-state-transitions">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-state-transitions" class="section-name selfRef">State Transitions</a>
        </h3>
<table class="center" id="table-7">
          <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">State</th>
              <th class="text-left" rowspan="1" colspan="1">Event</th>
              <th class="text-left" rowspan="1" colspan="1">Next State</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>INIT</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">New attestation lifecycle.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AWAITING_ATTESTER_PROOF</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AWAITING_ATTESTER_PROOF</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Phase 1 artifacts retrieved and validated.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>PROVING_TO_ATTESTER</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>PROVING_TO_ATTESTER</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Sign Phase 2 with ephemeral key.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AWAITING_EVIDENCE</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>AWAITING_EVIDENCE</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Phase 3 artifacts retrieved.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>VALIDATING</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>VALIDATING</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">Sign final AR with long-term identity key</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>SUCCESS</code>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Any</td>
              <td class="text-left" rowspan="1" colspan="1">Any validation check fails or timeout.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>FAIL</code>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="attestation-renewal-specification">
<section id="section-10">
      <h2 id="name-attestation-renewal-specifi">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-attestation-renewal-specifi" class="section-name selfRef">Attestation Renewal Specification</a>
      </h2>
<p id="section-10-1">This section specifies the attestation renewal procedures for instances that possess an existing credential (a Renewal Factor) from a prior attestation.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">A preliminary formal model for this procedure and its security properties are provided. See []{#core-security-properties-renewal-model}<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="attestation-renewal-prerequisites">
<section id="section-10.1">
        <h3 id="name-prerequisites">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-prerequisites" class="section-name selfRef">Prerequisites</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-10.1-1.1">The instance possesses a Renewal Factor (RF).<a href="#section-10.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.1-1.2">The Verifying Relying Party (VRP) has a record of the expected identity associated with the <code>RF</code>.<a href="#section-10.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-10.1-1.3">The Binding Factor (BF) remains stable or is updated according to policy.<a href="#section-10.1-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="generic-renewal-pattern">
<section id="section-10.2">
        <h3 id="name-generic-attestation-renewal">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-generic-attestation-renewal" class="section-name selfRef">Generic Attestation Renewal Pattern</a>
        </h3>
<p id="section-10.2-1">The attestation renewal procedure is a single-phase exchange.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2"><strong>Attester actions:</strong>
1.  Collect the current Instance Factor (IF), such as fresh measurements or quotes.
2.  Construct an Evidence payload containing <code>{BF, RF, IF, attestation_procedure_id, timestamp}</code>.
3.  Sign the Evidence with a key derived from the <code>RF</code>.
4.  Transmit the signed Evidence to the Verifying Relying Party (VRP).<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3"><strong>Verifying Relying Party (VRP) actions:</strong>
1.  Receive the Evidence payload.
2.  Validate the <code>RF</code> signature against the known credential.
3.  Verify that the <code>RF</code> subject matches the expected identity for the <code>BF</code>.
4.  Appraise the <code>IF</code> measurements against policy.
5.  Confirm the <code>attestation_procedure_id</code> is unique to prevent replay.
6.  If all checks pass, emit an updated Attestation Result (AR).<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<div id="attestation-renewal-validation-gates">
<section id="section-10.2.1">
          <h4 id="name-validation-gates-2">
<a href="#section-10.2.1" class="section-number selfRef">10.2.1. </a><a href="#name-validation-gates-2" class="section-name selfRef">Validation Gates</a>
          </h4>
<p id="section-10.2.1-1">These gates align with the formal model's events (see []{#core-security-properties-renewal-model}).<a href="#section-10.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.2.1-2">
<li id="section-10.2.1-2.1">
              <p id="section-10.2.1-2.1.1"><strong>RF Signature Verification</strong>: Validates credential authenticity<a href="#section-10.2.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.1-2.1.2.1">Failure: <code>CREDENTIAL_INVALID</code><a href="#section-10.2.1-2.1.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-10.2.1-2.2">
              <p id="section-10.2.1-2.2.1"><strong>Identity Continuity</strong>: Confirms RF subject matches expected identity<a href="#section-10.2.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.1-2.2.2.1">Failure: <code>IDENTITY_MISMATCH</code><a href="#section-10.2.1-2.2.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-10.2.1-2.3">
              <p id="section-10.2.1-2.3.1"><strong>Measurement Appraisal</strong>: Verifies IF against policy (e.g., CoRIM)<a href="#section-10.2.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.1-2.3.2.1">Failure: <code>MEASUREMENT_REJECTED</code><a href="#section-10.2.1-2.3.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-10.2.1-2.4">
              <p id="section-10.2.1-2.4.1"><strong>Freshness Binding</strong>: Ensures attestation_procedure_id is unique and properly bound<a href="#section-10.2.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.1-2.4.2.1">Failure: <code>REPLAY_DETECTED</code> or <code>BINDING_INVALID</code><a href="#section-10.2.1-2.4.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="section-10.2.1-2.5">
              <p id="section-10.2.1-2.5.1"><strong>Timestamp Validation</strong>: Confirms Evidence timestamp within acceptable window<a href="#section-10.2.1-2.5.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.1-2.5.2.1">Failure: <code>TIME_EXPIRED</code><a href="#section-10.2.1-2.5.2.1" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ol>
</section>
</div>
<div id="attestation-renewal-transport-specific">
<section id="section-10.2.2">
          <h4 id="name-transport-specific-implemen">
<a href="#section-10.2.2" class="section-number selfRef">10.2.2. </a><a href="#name-transport-specific-implemen" class="section-name selfRef">Transport-Specific Implementations</a>
          </h4>
<div id="session-bound-d-tls-pattern">
<section id="section-10.2.2.1">
            <h5 id="name-session-bound-dtls-pattern">
<a href="#section-10.2.2.1" class="section-number selfRef">10.2.2.1. </a><a href="#name-session-bound-dtls-pattern" class="section-name selfRef">Session-Bound (D)TLS Pattern</a>
            </h5>
<p id="section-10.2.2.1-1">When using TLS Exported Authenticators <span>[<a href="#RFC9261" class="cite xref">RFC9261</a>]</span>:<a href="#section-10.2.2.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.2.1-2.1">
                <strong>Binding Factor</strong>: Server's X.509 certificate public key<a href="#section-10.2.2.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-10.2.2.1-2.2">
                <strong>Renewal Factor</strong>: Prior EAT from bootstrap<a href="#section-10.2.2.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-10.2.2.1-2.3">
                <strong>Instance Factor</strong>: Fresh TEE Quote with attestation_procedure_id in REPORTDATA<a href="#section-10.2.2.1-2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-10.2.2.1-2.4">
                <strong>attestation_procedure_id</strong>: <code>certificate_request_context</code> from CertificateRequest<a href="#section-10.2.2.1-2.4" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-10.2.2.1-3"><strong>Freshness</strong>: Cryptographic binding of Quote to session context ensures per-connection freshness.<a href="#section-10.2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-10.2.2.1-4"><strong>Security</strong>: TLS 1.3 forward secrecy + RF validation + Quote appraisal<a href="#section-10.2.2.1-4" class="pilcrow">¶</a></p>
<p id="section-10.2.2.1-5">See <span><a href="#concrete-example-continuous-tee-attestation-over-dtls">#concrete-example-continuous-tee-attestation-over-dtls</a></span> for a complete example.<a href="#section-10.2.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="custom-transport-pattern">
<section id="section-10.2.2.2">
            <h5 id="name-custom-transport-pattern">
<a href="#section-10.2.2.2" class="section-number selfRef">10.2.2.2. </a><a href="#name-custom-transport-pattern" class="section-name selfRef">Custom Transport Pattern</a>
            </h5>
<p id="section-10.2.2.2-1">Implementations using other transports MUST ensure:<a href="#section-10.2.2.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-10.2.2.2-2.1">Renewal Factor (RF) signature verification<a href="#section-10.2.2.2-2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-10.2.2.2-2.2">Exchange Identifier uniqueness (replay protection)<a href="#section-10.2.2.2-2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-10.2.2.2-2.3">Instance Factor freshness (e.g., timestamps, nonces, or context binding)<a href="#section-10.2.2.2-2.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-10.2.2.2-2.4">Integrity protection of Evidence payload<a href="#section-10.2.2.2-2.4" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="post-attestation-patterns">
<section id="section-11">
      <h2 id="name-post-attestation-patterns">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-post-attestation-patterns" class="section-name selfRef">Post-Attestation Patterns</a>
      </h2>
<p id="section-11-1">Once an attestation procedure concludes, the Attestation Result (AR) can be used to make policy decisions. A Verifier may transmit the AR to the successful Attester, which can then present it to Relying Parties (RPs) that trust the Verifier's signature. The full scope of AR presentation to RPs is outside the scope of this document.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11-2">
<pre>   Attester                  Verifier               Relying Party
 (Workload)            (Attestation Service)    (CA / IAM System)
      |                           |                       |
      |----- Evidence ----------&gt; |                       |
      | (e.g., configuration)     |..Appraise vs. Policy..|
      |                           | (e.g., platform state |
      |&lt;--- Attestation Result ---|                       |
      |                                                   |
      |--------------------- CSR + Attestation Result----&gt;|
      |                                                   |
      |&lt;--------------------- Certificate / Token --------|
</pre><a href="#section-11-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">This section addresses security properties and considerations for ECA attestation procedures.<a href="#section-12-1" class="pilcrow">¶</a></p>
<div id="security-analysis-scope">
<section id="section-12.1">
        <h3 id="name-security-analysis-scope">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-security-analysis-scope" class="section-name selfRef">Security Analysis Scope</a>
        </h3>
<p id="section-12.1-1">The preliminary formal security analysis presented in this document (see <span><a href="#app-formal-modelling-informative">#app-formal-modelling-informative</a></span>) covers both the <strong>identity bootstrap procedure</strong> and the <strong>attestation renewal procedure</strong>. The identity bootstrap procedure assumes no prior relationship between Attester and Verifier and must establish initial trust through cryptographic proof of joint factor possession. Attestation renewals assume an existing credential from prior attestation and operate under different threat models, with security properties that depend on the integrity of the initial bootstrap, the Renewal Factor credential, and transport-specific properties.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identity-bootstrap-procedure-security">
<section id="section-12.2">
        <h3 id="name-identity-bootstrap-procedure">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-identity-bootstrap-procedure" class="section-name selfRef">Identity Bootstrap Procedure Security</a>
        </h3>
<p id="section-12.2-1">The Verifier's ability to appraise evidence is anchored in a trust model that relies on upstream supply chain roles. An Endorser (e.g., a hardware manufacturer) supplies endorsements for the hardware's authenticity, while a Reference Value Provider supplies the expected 'golden' measurements for the software stack. The Verifier is configured to trust these entities when making its appraisal decision.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2"><strong>Trust Boundaries:</strong> Without hardware roots of trust, the security scope is limited to passive network observers rather than compromised infrastructure providers. Hardware-rooted Instance Factor Pattern A addresses this limitation. For detailed pattern specifications, see []{#instance-factor-patterns-ifp}. This hardware-based protection is critical for mitigating State Reveal attacks, as preliminary formal analysis confirmed that a compromise of the Attester's software environment can expose ephemeral keys used in the attestation procedure (see <span><a href="#attester-state-reveal">#attester-state-reveal</a></span>).<a href="#section-12.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2-3"><strong>Secrets Handling:</strong> Derived keys are sensitive cryptographic material. Implementations MUST handle them securely in memory (e.g., using locked memory pages) and explicitly zeroize them after use.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attestation-renewal-security">
<section id="section-12.3">
        <h3 id="name-attestation-renewal-securit">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-attestation-renewal-securit" class="section-name selfRef">Attestation Renewal Security</a>
        </h3>
<blockquote id="section-12.3-1">
          <p id="section-12.3-1.1">Note: Unlike identity bootstrap procedures, attestation renewal does not protect against initial identity forgery. If an attacker compromises the identity bootstrap procedure, they can obtain a valid <code>RF</code> and perform subsequent attestation renewals. Therefore, security of the identity bootstrap procedure (including a hardware-rooted <code>IF</code> for zero-trust scenarios) remains critical for overall system security.<a href="#section-12.3-1.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-12.3-2">Re-attestation security derives from:<a href="#section-12.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-12.3-3">
<li id="section-12.3-3.1">
            <strong>Bootstrap foundation</strong>: The initial credential established via a cryptographically verified bootstrap acts as the Renewal Factor (RF).<a href="#section-12.3-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-12.3-3.2">
            <strong>Transport security</strong>: Channel properties (e.g., TLS 1.3 forward secrecy).<a href="#section-12.3-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-12.3-3.3">
            <strong>Continuous appraisal</strong>: Fresh IF measurements validated against policy.<a href="#section-12.3-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-12.3-3.4">
            <strong>Replay protection</strong>: Exchange Identifier uniqueness enforcement.<a href="#section-12.3-3.4" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="impersonation-risk">
<section id="section-12.4">
        <h3 id="name-impersonation-risk">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-impersonation-risk" class="section-name selfRef">Impersonation Risk</a>
        </h3>
<p id="section-12.4-1">The security properties of the identity bootstrap procedure depend on an adversary being unable to generate a valid cryptographic proof for an Instance Factor (IF) they do not legitimately possess. An impersonation attack would require an adversary to forge a proof (e.g., a TPM quote) corresponding to a known <code>IF</code> for a specific attestation procedure's Binding Factor (BF). The protocol's primary defense is that the <code>IF</code> itself is never transmitted, only a proof derived from it. Therefore, operational controls MUST protect the integrity of the measurement source (e.g., a vTPM) and the out-of-band channel through which the Verifier learns the expected measurement.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<p id="section-12.4-2">To reduce this risk, operators SHOULD minimize the time window between when an Attester becomes operational with its <code>BF</code> and when a Verifier is available to appraise its evidence.<a href="#section-12.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="enforcing-factor-structure">
<section id="section-12.5">
        <h3 id="name-enforcing-factor-structure">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-enforcing-factor-structure" class="section-name selfRef">Enforcing Factor Structure</a>
        </h3>
<p id="section-12.5-1">The protocol's security model requires the Binding Factor to provide high entropy (at least 128 bits) while the Instance Factor (IF) provides unique, verifiable identification. These serve distinct architectural roles. Verifiers MUST validate that <code>IF</code> conform to expected structural patterns for the claimed Instance Factor Pattern (IFP). An <code>IF</code> that appears to be random entropy rather than a structured identifier indicates either a protocol violation or a provisioning failure and MUST result in attestation rejection. This enforcement mechanism provides operational defense against misconfigurations where both factors might be derived from shared entropy sources, as such misconfigurations would produce <code>IF</code> that fail structural validation<a href="#section-12.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="threat-models">
<section id="section-12.6">
        <h3 id="name-threat-models">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-threat-models" class="section-name selfRef">Threat Models</a>
        </h3>
<p id="section-12.6-1">ECA is designed to address two key threat models: the <strong>Network Attacker</strong> (a Dolev-Yao-style MiTM who controls communication but not participant state) and the <strong>Malicious Provider</strong> (a privileged insider with control-plane access). Preliminary analysis from an exploratory ProVerif model suggests that the protocol, as modelled, defeats the Network Attacker through its cryptographic binding and joint possession proofs.<a href="#section-12.6-1" class="pilcrow">¶</a></p>
<p id="section-12.6-2">The choice of Instance Factor Pattern directly maps to the desired security goals:
-   <strong>IFP Patterns B and C</strong> are sufficient for workload portability and standardization. They protect against Network Attackers but assume the underlying infrastructure provider is trusted.
-   <strong>IFP Pattern A</strong> is designed for high-assurance and zero-trust environments. By anchoring the <code>IF</code> in a hardware root of trust (HRoT), it is sufficient to mitigate the Malicious Provider threat model.<a href="#section-12.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attester-state-compromise">
<section id="section-12.7">
        <h3 id="name-attester-state-compromise">
<a href="#section-12.7" class="section-number selfRef">12.7. </a><a href="#name-attester-state-compromise" class="section-name selfRef">Attester State Compromise</a>
        </h3>
<p id="section-12.7-1">The preliminary formal model confirms that the protocol cannot maintain secrecy of the Validator Factor (VF) if the Attester's runtime state is compromised and its ephemeral decryption key is extracted. A preliminary "State Reveal" analysis was conducted where the Attester's ephemeral private key was deliberately leaked to an attacker (see <span><a href="#attester-state-reveal">#attester-state-reveal</a></span>). The model confirmed that this compromise allows a passive network attacker to intercept and decrypt the Phase 2 ciphertext from the Verifier, revealing the <code>VF</code>.<a href="#section-12.7-1" class="pilcrow">¶</a></p>
<p id="section-12.7-2">This result establishes the protocol's security boundary regarding the Attester's runtime state. The only viable mitigation for this threat is the use of IFP Pattern A (hardware-rooted), where the Instance Factor and all keys derived from it are protected by a hardware root of trust.<a href="#section-12.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifier-key-compromise-impact-analysis">
<section id="section-12.8">
        <h3 id="name-verifier-key-compromise-imp">
<a href="#section-12.8" class="section-number selfRef">12.8. </a><a href="#name-verifier-key-compromise-imp" class="section-name selfRef">Verifier Key Compromise Impact Analysis</a>
        </h3>
<p id="section-12.8-1">The Verifier uses two distinct types of keys in the identity bootstrap procedure:<a href="#section-12.8-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-12.8-2">
<li id="section-12.8-2.1">
            <strong>Ephemeral Procedure Key</strong>: Used to sign Phase 2 artifacts (<code>VF</code> + <code>vnonce</code>)<a href="#section-12.8-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-12.8-2.2">
            <strong>Long-term Identity Key</strong>: Used to sign final Attestation Results (<code>AR</code>)<a href="#section-12.8-2.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="key-management-requirements">
<section id="section-12.9">
        <h3 id="name-key-management-requirements">
<a href="#section-12.9" class="section-number selfRef">12.9. </a><a href="#name-key-management-requirements" class="section-name selfRef">Key Management Requirements</a>
        </h3>
<div id="ephemeral-procedure-keys">
<section id="section-12.9.1">
          <h4 id="name-ephemeral-procedure-keys">
<a href="#section-12.9.1" class="section-number selfRef">12.9.1. </a><a href="#name-ephemeral-procedure-keys" class="section-name selfRef">Ephemeral Procedure Keys</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-12.9.1-1.1">MUST be generated fresh for each identity bootstrap procedure<a href="#section-12.9.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.9.1-1.2">MUST be discarded after procedure completion<a href="#section-12.9.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.9.1-1.3">SHOULD use Ed25519 for performance and security<a href="#section-12.9.1-1.3" class="pilcrow">¶</a>
</li>
          </ul>
<div id="ephemeral-procedure-key-compromise">
<section id="section-12.9.1.1">
            <h5 id="name-ephemeral-procedure-key-com">
<a href="#section-12.9.1.1" class="section-number selfRef">12.9.1.1. </a><a href="#name-ephemeral-procedure-key-com" class="section-name selfRef">Ephemeral Procedure Key Compromise</a>
            </h5>
<p id="section-12.9.1.1-1">The Verifier MUST generate a fresh ephemeral keypair for each identity bootstrap procedure to sign Phase 2 artifacts. This key is single-use and discarded after the procedure completes.<a href="#section-12.9.1.1-1" class="pilcrow">¶</a></p>
<p id="section-12.9.1.1-2">If an ephemeral procedure key is compromised during an active bootstrap procedure, an attacker could:
- Inject forged (VF', nonce') pairs for that specific procedure
- Cause the Attester to derive incorrect final identity keys<a href="#section-12.9.1.1-2" class="pilcrow">¶</a></p>
<p id="section-12.9.1.1-3">However, the protocol's cryptographic design ensures this only enables denial of service, not authentication bypass:
- The resulting Evidence will contain wrong nonce (fails Gate 8)
- Wrong <code>pop_tag</code> (fails Gate 9)<br>
- No legitimate Verifier should accept this Evidence<a href="#section-12.9.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="long-term-identity-keys">
<section id="section-12.9.2">
          <h4 id="name-long-term-identity-keys">
<a href="#section-12.9.2" class="section-number selfRef">12.9.2. </a><a href="#name-long-term-identity-keys" class="section-name selfRef">Long-term Identity Keys</a>
          </h4>
<ul class="compact">
<li class="compact" id="section-12.9.2-1.1">MUST be protected as high-value assets<a href="#section-12.9.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.9.2-1.2">MUST be used only to sign final Attestation Results<a href="#section-12.9.2-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.9.2-1.3">SHOULD be rotated according to organizational policy<a href="#section-12.9.2-1.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-12.9.2-1.4">MAY be backed by organizational PKI for trust distribution<a href="#section-12.9.2-1.4" class="pilcrow">¶</a>
</li>
          </ul>
<div id="long-term-identity-key-compromise">
<section id="section-12.9.2.1">
            <h5 id="name-long-term-identity-key-comp">
<a href="#section-12.9.2.1" class="section-number selfRef">12.9.2.1. </a><a href="#name-long-term-identity-key-comp" class="section-name selfRef">Long-term Identity Key Compromise</a>
            </h5>
<p id="section-12.9.2.1-1">Compromise of the Verifier's long-term identity key used to sign Attestation Results would allow an attacker to forge ARs. This represents a complete compromise of the trust domain and requires immediate revocation and reissuance of the Verifier's identity credentials.<a href="#section-12.9.2.1-1" class="pilcrow">¶</a></p>
<p id="section-12.9.2.1-2">The impact is independent of transport mechanism and affects all relying parties that trust the compromised key.<a href="#section-12.9.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="operational-considerations">
<section id="section-13">
      <h2 id="name-operational-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<p id="section-13-1"><strong>Scalability:</strong> The use of a simple artifact repository allows for high scalability using standard web infrastructure like CDNs and object storage.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2"><strong>Time Synchronization:</strong> Reasonably synchronized time is REQUIRED for proper validation of time-based claims. The use of a time synchronization protocol like NTP <span>[<a href="#RFC5905" class="cite xref">RFC5905</a>]</span> is RECOMMENDED.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3"><strong>Polling:</strong> For repository-based transports, polling MUST use exponential backoff with jitter.<a href="#section-13-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-14-1">TODO IANA<a href="#section-14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-status">
<section id="section-15">
      <h2 id="name-implementation-status">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-15-1">An end-to-end implementation of the bootstrap profile (tracked at <a href="https://github.com/eca-sae/prototype-eca-sae/tree/proto-0.1.0">https://github.com/eca-sae/prototype-eca-sae/tree/proto-0.1.0</a>), demonstrating the three-phase attestation procedure over an experimental pull-only "dead drop" transport layer called SAE <span>[<a href="#I-D.ritz-sae" class="cite xref">I-D.ritz-sae</a>]</span>. The reference implementation executes the composed cryptography with an average of approx 34ms on constrained hardware with full protocol execution in 1.3s. Future work includes demonstration over conventional REST/TLS.<a href="#section-15-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-16">
      <h2 id="name-acknowledgments">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-16-1">The design of this protocol was heavily influenced by the simplicity and security goals of the age file encryption tool. The protocol's core cryptographic mechanisms would not be as simple or robust without the prior work of the IETF community in standardizing modern primitives, particularly Hybrid Public Key Encryption (HPKE) in <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span>.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">The integration with Exported Authenticators draws from <span>[<a href="#I-D.fossati-tls-exported-attestation" class="cite xref">I-D.fossati-tls-exported-attestation</a>]</span>. The authors wish to thank the contributors of this foundational draft for making this work possible.<a href="#section-16-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-17">
      <h2 id="name-references">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-17.1">
        <h3 id="name-normative-references">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9334">[RFC9334]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote ATtestation procedureS (RATS) Architecture"</span>, <span class="seriesInfo">RFC 9334</span>, <span class="seriesInfo">DOI 10.17487/RFC9334</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9334">https://www.rfc-editor.org/info/rfc9334</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9711">[RFC9711]</dt>
      <dd>
<span class="refAuthor">Lundblade, L.</span>, <span class="refAuthor">Mandyam, G.</span>, <span class="refAuthor">O'Donoghue, J.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"The Entity Attestation Token (EAT)"</span>, <span class="seriesInfo">RFC 9711</span>, <span class="seriesInfo">DOI 10.17487/RFC9711</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9711">https://www.rfc-editor.org/info/rfc9711</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-17.2">
        <h3 id="name-informative-references">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.fossati-tls-exported-attestation">[I-D.fossati-tls-exported-attestation]</dt>
        <dd>
<span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Sardar, M. U.</span>, <span class="refAuthor">Reddy.K, T.</span>, <span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">I. Mihalcea</span>, <span class="refTitle">"Remote Attestation with Exported Authenticators"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fossati-tls-exported-attestation-02</span>, <time datetime="2025-07-03" class="refDate">3 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fossati-tls-exported-attestation-02">https://datatracker.ietf.org/doc/html/draft-fossati-tls-exported-attestation-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-corim">[I-D.ietf-rats-corim]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Fossati, T.</span>, <span class="refAuthor">Deshpande, Y.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Concise Reference Integrity Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-corim-08</span>, <time datetime="2025-07-07" class="refDate">7 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-08">https://datatracker.ietf.org/doc/html/draft-ietf-rats-corim-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-posture-assessment">[I-D.ietf-rats-posture-assessment]</dt>
        <dd>
<span class="refAuthor">Moriarty, K.</span>, <span class="refAuthor">Wiseman, M.</span>, <span class="refAuthor">Stein, A. J.</span>, and <span class="refAuthor">C. Nelogal</span>, <span class="refTitle">"Remote Posture Assessment for Systems, Containers, and Applications at Scale"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-posture-assessment-03</span>, <time datetime="2025-07-07" class="refDate">7 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-posture-assessment-03">https://datatracker.ietf.org/doc/html/draft-ietf-rats-posture-assessment-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-reference-interaction-models">[I-D.ietf-rats-reference-interaction-models]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Eckel, M.</span>, <span class="refAuthor">Pan, W.</span>, and <span class="refAuthor">E. Voit</span>, <span class="refTitle">"Reference Interaction Models for Remote Attestation Procedures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-reference-interaction-models-14</span>, <time datetime="2025-07-07" class="refDate">7 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-14">https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ritz-sae">[I-D.ritz-sae]</dt>
        <dd>
<span class="refAuthor">Ritz, N.</span>, <span class="refTitle">"Static Artifact Exchange (SAE) Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ritz-sae-01</span>, <time datetime="2025-09-29" class="refDate">29 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ritz-sae-01">https://datatracker.ietf.org/doc/html/draft-ritz-sae-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5905">[RFC5905]</dt>
        <dd>
<span class="refAuthor">Mills, D.</span>, <span class="refAuthor">Martin, J., Ed.</span>, <span class="refAuthor">Burbank, J.</span>, and <span class="refAuthor">W. Kasch</span>, <span class="refTitle">"Network Time Protocol Version 4: Protocol and Algorithms Specification"</span>, <span class="seriesInfo">RFC 5905</span>, <span class="seriesInfo">DOI 10.17487/RFC5905</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5905">https://www.rfc-editor.org/info/rfc5905</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8995">[RFC8995]</dt>
        <dd>
<span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructure (BRSKI)"</span>, <span class="seriesInfo">RFC 8995</span>, <span class="seriesInfo">DOI 10.17487/RFC8995</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8995">https://www.rfc-editor.org/info/rfc8995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9180">https://www.rfc-editor.org/info/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9261">[RFC9261]</dt>
      <dd>
<span class="refAuthor">Sullivan, N.</span>, <span class="refTitle">"Exported Authenticators in TLS"</span>, <span class="seriesInfo">RFC 9261</span>, <span class="seriesInfo">DOI 10.17487/RFC9261</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9261">https://www.rfc-editor.org/info/rfc9261</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="app-formal-modelling-informative">
<section id="appendix-A">
      <h2 id="name-preliminary-formal-modellin">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-preliminary-formal-modellin" class="section-name selfRef">Preliminary Formal Modelling (Informative)</a>
      </h2>
<p id="appendix-A-1">Note that the formal analysis is currently a work-in-progress. This appendix presents the preliminary and ongoing formal security analyses of the ECA <strong>identity bootstrap procedure</strong> and the <strong>attestation renewal procedure</strong> using ProVerif (tracked at <a href="https://github.com/eca-sae/internet-drafts-eca-sae/tree/pv.0.6.0/formal-model">https://github.com/eca-sae/internet-drafts-eca-sae/tree/pv.0.6.0/formal-model</a>. The analysis assumes a Dolev–Yao network attacker and verifies core security properties for each procedure. The model assumes a powerful Dolev-Yao network attacker who can intercept, modify, and inject messages. It also models the Binding Factor (<code>BF</code>) as public knowledge from the start, as per the protocol's "exposure tolerance" principle (<span><a href="#core-design-principles">#core-design-principles</a></span>).<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">The analysis was conducted in two parts: examination of the core security properties against a network attacker, and an analysis of the protocol's behavior under specific key compromise scenarios to define its security boundaries.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="core-security-properties-bootstrap-model">
<section id="appendix-A.1">
        <h3 id="name-core-security-properties-bo">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-core-security-properties-bo" class="section-name selfRef">Core Security Properties (Bootstrap)</a>
        </h3>
<p id="appendix-A.1-1">In the baseline model, all core security goals were successfully shown to hold against a network attacker.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-8">
          <caption><a href="#table-8" class="selfRef">Table 8</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Property</th>
              <th class="text-left" rowspan="1" colspan="1">ProVerif Query</th>
              <th class="text-left" rowspan="1" colspan="1">Result</th>
              <th class="text-left" rowspan="1" colspan="1">Interpretation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Authentication</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>inj-event(VerifierAccepts(...)) ==&gt; inj-event(AttesterInitiates(...))</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>True</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">The Verifier only accepts an attestation if a unique Attester legitimately initiated it. This prevents an attacker from impersonating the Attester.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Freshness</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>event(AttesterUsesNonce(n)) ==&gt; event(VerifierGeneratesNonce(n))</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>True</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">The Attester will only use a nonce that was genuinely generated by the Verifier for that attestion procedure. This property is the basis for <strong>Gate 8 (Nonce Match)</strong> and prevents replay attacks.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Key Binding</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>event(VerifierValidatesBinding(...,pk,n)) ==&gt; event(AttesterPresentsKey(pk))</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>True</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">The final identity key that the Verifier checks is unambiguously bound to the Attester that participated in the attestation procedure, validating <strong>Gate 9 (pop_tag)</strong>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Confidentiality</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>not (event(VFReleased(vf)) &amp;&amp; attacker(vf))</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>True</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">The secret <code>ValidatorFactor</code> (<code>VF</code>) is never revealed to a network attacker, satisfying a fundamental security goal of the protocol.</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="core-security-properties-renewal-model">
<section id="appendix-A.2">
        <h3 id="name-core-security-properties-at">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-core-security-properties-at" class="section-name selfRef">Core Security Properties (Attestation Renewal)</a>
        </h3>
<p id="appendix-A.2-1"><strong>Model summary.</strong> The renewal model binds <strong>BF+IF+RF</strong> and uses the TLS <code>certificate_request_context</code> as the freshness nonce (<code>REPORTDATA = hash(context)</code>), matching the renewal spec and the (D)TLS EA example.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-9">
          <caption><a href="#table-9" class="selfRef">Table 9</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Property</th>
              <th class="text-left" rowspan="1" colspan="1">ProVerif Query</th>
              <th class="text-left" rowspan="1" colspan="1">Result</th>
              <th class="text-left" rowspan="1" colspan="1">Interpretation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Authentication</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>inj-event(VRPAcceptsRenewal(...,ctx)) ==&gt; inj-event(AttesterAnswersChallenge(...,ctx))</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>True</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Verifier accepts only if a unique Attester legitimately initiated this renewal.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Freshness (context)</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>event(AttesterUsesContext(ctx)) ==&gt; event(VRPGeneratesContext(ctx))</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>True</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">Evidence is fresh and bound to the Verifier-generated EA context.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>RF integrity</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>event(ValidRFVerified(rf)) ==&gt; event(AttesterAnswersChallenge(...,rf,ctx))</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>True</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">The presented RF corresponds to the ongoing renewal, not replay.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Measurement freshness</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>event(FreshMeasurementsVerified(ifa)) ==&gt; event(AttesterUsesContext(ctx))</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>True</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">TEE quote is fresh and correctly bound to the EA context.</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="boundary-analysis-advanced-threat-models">
<section id="appendix-A.3">
        <h3 id="name-boundary-analysis-advanced-">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-boundary-analysis-advanced-" class="section-name selfRef">Boundary Analysis (Advanced Threat Models)</a>
        </h3>
<p id="appendix-A.3-1">Additional tests were performed to formally define the protocol's security boundaries under specific compromise scenarios.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div id="key-compromise-impersonation-kci">
<section id="appendix-A.3.1">
          <h4 id="name-key-compromise-impersonatio">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-key-compromise-impersonatio" class="section-name selfRef">Key Compromise Impersonation (KCI)</a>
          </h4>
<p id="appendix-A.3.1-1">A test was conducted where an attacker compromises an <code>InstanceFactor</code> (<code>IF</code>) from one attestation procedure and attempts to impersonate a Verifier in a different procedure. The model indicated this attack is not possible. The KCI security query passed, confirming that compromising a secondary factor (<code>IF</code>) does not allow an attacker to forge messages from a primary party (the Verifier), as they still lack the Verifier's private signing key.<a href="#appendix-A.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifier-key-compromise">
<section id="appendix-A.3.2">
          <h4 id="name-verifier-key-compromise">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-verifier-key-compromise" class="section-name selfRef">Verifier Key Compromise</a>
          </h4>
<p id="appendix-A.3.2-1">A test was conducted modeling a compromised long-term Verifier signing key:<a href="#appendix-A.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3.2-2.1">
              <p id="appendix-A.3.2-2.1.1"><strong>Result:</strong> The model demonstrated that an attacker can inject arbitrary (VF', nonce') pairs, breaking the Freshness property (<code>event(AttesterUsesNonce(n)) ==&gt; event(VerifierGeneratesNonce(n))</code> was <strong>False</strong>).<a href="#appendix-A.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.3.2-2.2">
              <p id="appendix-A.3.2-2.2.1"><strong>Interpretation:</strong> While the preliminary formal model identifies a freshness violation, the protocol's cryptographic design ensures this only enables denial of service, not authentication bypass:<a href="#appendix-A.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.3.2-2.3">
              <p id="appendix-A.3.2-2.3.1">The attacker can cause the Attester to derive keys from (<code>BF</code>, <code>VF'</code>)<a href="#appendix-A.3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.3.2-2.4">
              <p id="appendix-A.3.2-2.4.1">However, the protocol's cryptographic design ensures this only enables denial of service, not authentication bypass:<a href="#appendix-A.3.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="appendix-A.3.2-2.4.2.1">The resulting Evidence will contain wrong nonce (fails Gate 8)<a href="#appendix-A.3.2-2.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact normal" id="appendix-A.3.2-2.4.2.2">Wrong <code>pop_tag</code> (fails Gate 9)<br><a href="#appendix-A.3.2-2.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact normal" id="appendix-A.3.2-2.4.2.3">No legitimate Verifier should accept this Evidence<a href="#appendix-A.3.2-2.4.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-A.3.2-2.5">
              <p id="appendix-A.3.2-2.5.1"><strong>Mitigation:</strong> This analysis provides the rationale for ephemeral keys for each unique bootstrapping procedure<a href="#appendix-A.3.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="attester-state-reveal">
<section id="appendix-A.3.3">
          <h4 id="name-attester-state-reveal">
<a href="#appendix-A.3.3" class="section-number selfRef">A.3.3. </a><a href="#name-attester-state-reveal" class="section-name selfRef">Attester State Reveal</a>
          </h4>
<p id="appendix-A.3.3-1">A test was conducted modeling a compromised Attester whose ephemeral private decryption key is leaked:<a href="#appendix-A.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3.3-2.1">
              <p id="appendix-A.3.3-2.1.1"><strong>Result:</strong> The model demonstrated that this allows a passive attacker to decrypt the Phase 2 ciphertext and steal the <code>ValidatorFactor</code> (<code>VF</code>) (<code>not (event(VFReleased(vf)) &amp;&amp; attacker(vf))</code> was <strong>False</strong>).<a href="#appendix-A.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.3.3-2.2">
              <p id="appendix-A.3.3-2.2.1"><strong>Interpretation:</strong> This result formally establishes the security boundary discussed in <span><a href="#attester-state-compromise">#attester-state-compromise</a></span><a href="#appendix-A.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.3.3-2.3">
              <p id="appendix-A.3.3-2.3.1"><strong>Mitigation:</strong> This analysis provides the rationale for hardware-rooted Instance Factor Pattern A when the threat model must assume compromise of the underlying provisioning platform. For pattern specifications, see <span><a href="#instance-factor-patterns-ifp">#instance-factor-patterns-ifp</a></span>.<a href="#appendix-A.3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="normative-eca-v1-profiles">
<section id="appendix-B">
      <h2 id="name-normative-eca-v1-profiles">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-normative-eca-v1-profiles" class="section-name selfRef">Normative ECA-V1 Profiles</a>
      </h2>
<p id="appendix-B-1">This document defines the protocol abstractly. Concrete cryptographic mechanisms are supplied by profiles. A conforming implementation MUST implement at least one profile, and any chosen profile MUST preserve all requirements in <span><a href="#protocol-requirements-normative">#protocol-requirements-normative</a></span>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">Key Separation (Architecture requirement): Regardless of profile, implementations MUST maintain strict separation between:
- Phase 2 encryption keys (used by the Verifier to release VF to the Attester), and
- Phase 3 identity/signing keys (used by the Attester to sign Evidence/EAT).<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">Profiles typically achieve separation via domain-separated KDF invocations; however, any mechanism that guarantees computational unlinkability between Phase 2 and Phase 3 key material is acceptable, provided the invariants in <span><a href="#protocol-requirements-normative">#protocol-requirements-normative</a></span> remain intact.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<div id="sec-pop">
<section id="appendix-B.1">
        <h3 id="name-proof-of-possession-constru">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-proof-of-possession-constru" class="section-name selfRef">Proof-of-Possession Construction (Bootstrap)</a>
        </h3>
<p id="appendix-B.1-1">A profile MUST provide a PoP mechanism that proves joint-possession of both factors used across the ceremony and binds the result to the session context. At minimum, the PoP's authenticated input MUST cover:<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.1-2.1">Ceremony identifier (e.g., <code>eca_uuid</code> or <code>certificate_request_context</code>),<a href="#appendix-B.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.1-2.2">the Integrity Hash Beacon (IHB) or an equivalent <code>BF</code>+<code>IF</code> binding,<a href="#appendix-B.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.1-2.3">the Attester's Phase-3 signing public key, and<a href="#appendix-B.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.1-2.4">the Verifier's freshness input (e.g., <code>vnonce</code>).<a href="#appendix-B.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-B.1-3">The PoP output MUST be verifiable by the Verifier without additional round trips and MUST be integrity-protected under a key that is infeasible to compute without both factors required by the active profile.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bootstrap-reference-profile">
<section id="appendix-C">
      <h2 id="name-eca-vm-bootstrap-v1-mti-pro">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-eca-vm-bootstrap-v1-mti-pro" class="section-name selfRef">ECA-VM-BOOTSTRAP-V1 MTI Profile</a>
      </h2>
<div id="primitives">
<section id="appendix-C.1">
        <h3 id="name-primitives">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-primitives" class="section-name selfRef">Primitives</a>
        </h3>
<ul class="compact">
<li class="compact" id="appendix-C.1-1.1">Hash / KDF: HKDF-SHA-256 (RFC5869), SHA-256 (RFC6234)<a href="#appendix-C.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.1-1.2">MAC: HMAC-SHA-256<a href="#appendix-C.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.1-1.3">Signatures: Ed25519 (RFC8032)<a href="#appendix-C.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.1-1.4">KEM/HPKE: X25519 + HPKE base mode (RFC9180) for Verifier -&gt; Attester secrecy in Phase 2. The Exchange Identifier is used as the AAD, and the <code>info</code> parameter for key derivation is <code>"ECA/v1/hpke"</code>.<a href="#appendix-C.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.1-1.5">Nonces: Verifier freshness <code>vnonce</code> is exactly 16 bytes (encoded base64url, unpadded)<a href="#appendix-C.1-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="integrity-hash-beacon-ihb">
<section id="appendix-C.2">
        <h3 id="name-integrity-hash-beacon-ihb">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-integrity-hash-beacon-ihb" class="section-name selfRef">Integrity Hash Beacon (IHB)</a>
        </h3>
<ul class="compact">
<li class="compact" id="appendix-C.2-1.1">
            <code>IHB = SHA-256( BF || IF )</code>, rendered as lowercase hex for transport where necessary.<a href="#appendix-C.2-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="deterministic-key-material">
<section id="appendix-C.3">
        <h3 id="name-deterministic-key-material">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-deterministic-key-material" class="section-name selfRef">Deterministic Key Material</a>
        </h3>
<p id="appendix-C.3-1">All keys are deterministically derived from attestation procedure inputs via domain-separated HKDF invocations. Notation: <code>HKDF-Extract(salt, IKM)</code> then <code>HKDF-Expand(PRK, info, L)</code>. The Exchange Identifier is appended to the <code>salt</code> in all derivations to ensure session uniqueness.<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-2.1">
            <p id="appendix-C.3-2.1.1"><strong>Phase 1 MAC key (Attester artifact MAC)</strong><a href="#appendix-C.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="appendix-C.3-2.1.2.1">
                <code>IKM = BF || IF</code><a href="#appendix-C.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.1.2.2">
                <code>salt = "ECA:salt:auth:v1" || attestation_procedure_id</code><a href="#appendix-C.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.1.2.3">
                <code>info = "ECA:info:auth:v1"</code><a href="#appendix-C.3-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.1.2.4">
                <code>K_MAC_Ph1 = HKDF-Expand( HKDF-Extract(salt, IKM), info, 32 )</code><a href="#appendix-C.3-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.1.2.5">Usage: HMAC-SHA-256 over the CBOR Phase-1 payload bytes.<a href="#appendix-C.3-2.1.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.3-2.2">
            <p id="appendix-C.3-2.2.1"><strong>Phase 2 ECDH/HPKE seed (Attester's ephemeral X25519 keypair)</strong><a href="#appendix-C.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="appendix-C.3-2.2.2.1">
                <code>IKM = BF || IF</code><a href="#appendix-C.3-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.2.2.2">
                <code>salt = "ECA:salt:encryption:v1" || attestation_procedure_id</code><a href="#appendix-C.3-2.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.2.2.3">
                <code>info = "ECA:info:encryption:v1"</code><a href="#appendix-C.3-2.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.2.2.4">
                <code>seed32 = HKDF-Expand( HKDF-Extract(salt, IKM), info, 32 )</code><a href="#appendix-C.3-2.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.2.2.5">The Attester forms an X25519 private key by clamping <code>seed32</code> per RFC7748; the public key is derived normally.<a href="#appendix-C.3-2.2.2.5" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.2.2.6">The Verifier uses HPKE with the Attester's public key to encrypt <code>{VF, vnonce}</code>.<a href="#appendix-C.3-2.2.2.6" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.3-2.3">
            <p id="appendix-C.3-2.3.1"><strong>Phase 3 signing key (Attester's Ed25519 identity keypair)</strong><a href="#appendix-C.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="appendix-C.3-2.3.2.1">
                <code>IKM = BF || VF</code><a href="#appendix-C.3-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.3.2.2">
                <code>salt = "ECA:salt:composite-identity:v1" || attestation_procedure_id</code><a href="#appendix-C.3-2.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.3.2.3">
                <code>info = "ECA:info:composite-identity:v1"</code><a href="#appendix-C.3-2.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.3.2.4">
                <code>sk_seed32 = HKDF-Expand( HKDF-Extract(salt, IKM), info, 32 )</code><a href="#appendix-C.3-2.3.2.4" class="pilcrow">¶</a>
</li>
              <li class="compact normal" id="appendix-C.3-2.3.2.5">The Attester initializes Ed25519 with <code>sk_seed32</code> as the private key seed and derives the corresponding public key.<a href="#appendix-C.3-2.3.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.3-2.4">
            <p id="appendix-C.3-2.4.1"><strong>HPKE KDF <code>info</code> parameter:</strong> <code>info = "ECA/v1/hpke"</code><a href="#appendix-C.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="phase-artifacts-profile">
<section id="appendix-C.4">
        <h3 id="name-phase-artifacts">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-phase-artifacts" class="section-name selfRef">Phase Artifacts</a>
        </h3>
<p id="appendix-C.4-1"><em>This section provides a high-level description of the payloads. For concrete byte-for-byte examples, see the reference implementation.</em><a href="#appendix-C.4-1" class="pilcrow">¶</a></p>
<div id="phase-1-payload-attester-repo-profile">
<section id="appendix-C.4.1">
          <h4 id="name-phase-1-payload-attesterrep">
<a href="#appendix-C.4.1" class="section-number selfRef">C.4.1. </a><a href="#name-phase-1-payload-attesterrep" class="section-name selfRef">Phase 1 Payload (Attester→Repo)</a>
          </h4>
<p id="appendix-C.4.1-1">The Phase-1 payload is a CBOR map containing the following claims, which is then protected by an external HMAC tag.<a href="#appendix-C.4.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-10">
            <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Claim</th>
                <th class="text-left" rowspan="1" colspan="1">Value Type</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>kem_pub</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>bstr</code> (raw 32 bytes)</td>
                <td class="text-left" rowspan="1" colspan="1">Attester's ephemeral X25519 public key.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>ihb</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>tstr</code> (lowercase hex)</td>
                <td class="text-left" rowspan="1" colspan="1">Integrity Hash Beacon.</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="phase-2-payload-verifier-repo-profile">
<section id="appendix-C.4.2">
          <h4 id="name-phase-2-payload-verifier-re">
<a href="#appendix-C.4.2" class="section-number selfRef">C.4.2. </a><a href="#name-phase-2-payload-verifier-re" class="section-name selfRef">Phase 2 Payload (Verifier -&gt; Repo)</a>
          </h4>
<p id="appendix-C.4.2-1">The Phase-2 payload is a signed CBOR map containing the following claims.<a href="#appendix-C.4.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-11">
            <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Claim</th>
                <th class="text-left" rowspan="1" colspan="1">Value Type</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>C</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>tstr</code> (base64url unpadded)</td>
                <td class="text-left" rowspan="1" colspan="1">HPKE ciphertext</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>vnonce</code>
</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <code>tstr</code> (base64url unpadded)</td>
                <td class="text-left" rowspan="1" colspan="1">The Verifier-generated nonce.</td>
              </tr>
            </tbody>
          </table>
<p id="appendix-C.4.2-3">The plaintext for HPKE encryption is the direct concatenation of the raw bytes: <code>plaintext = VF || vnonce</code>.<a href="#appendix-C.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="phase-3-payload-attester-repo-profile">
<section id="appendix-C.4.3">
          <h4 id="name-phase-3-payload-attester-re">
<a href="#appendix-C.4.3" class="section-number selfRef">C.4.3. </a><a href="#name-phase-3-payload-attester-re" class="section-name selfRef">Phase 3 Payload (Attester -&gt; Repo)</a>
          </h4>
<p id="appendix-C.4.3-1">The Phase-3 payload is a signed EAT as defined in <span><a href="#evidence-claims">#evidence-claims</a></span>. The profile-specific constructions for the binding proof is as follows:<a href="#appendix-C.4.3-1" class="pilcrow">¶</a></p>
<p id="appendix-C.4.3-2"><strong>Derive binding key</strong>
- <code>IKM = BF || VF</code>
- <code>salt = "ECA:salt:binding:v1" || attestation_procedure_id</code>
- <code>info = "ECA:info:binding:v1"</code>
- <code>K_binding = HKDF-Expand(HKDF-Extract(salt, IKM), info, 32)</code><a href="#appendix-C.4.3-2" class="pilcrow">¶</a></p>
<p id="appendix-C.4.3-3"><strong>Compute single binding proof</strong>
- <code>bound_data = attestation_procedure_id || IHB || pubkey || vnonce</code>
- <code>pop_tag = HMAC-SHA-256(K_binding, bound_data)</code>
- The <code>pop_tag</code> are included in the EAT, which is then signed with the Attester's Ed25519 key.<a href="#appendix-C.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="verification-verifier-profile">
<section id="appendix-C.5">
        <h3 id="name-verification-verifier">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-verification-verifier" class="section-name selfRef">Verification (Verifier)</a>
        </h3>
<ul class="compact">
<li class="compact" id="appendix-C.5-1.1">Verify Phase-1 MAC with <code>K_MAC_Ph1</code>.<a href="#appendix-C.5-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.5-1.2">Verify the signed Phase-2 payload with the Verifier's public key; HPKE-Open with Attester's kem key to recover <code>{VF, vnonce}</code>.<a href="#appendix-C.5-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.5-1.3">Recompute Attester signing key from <code>BF||VF</code> and verify the EAT signature.<a href="#appendix-C.5-1.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.5-1.4">Recompute and <code>pop_tag</code> inputs and compare constant-time.<a href="#appendix-C.5-1.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.5-1.5">Apply local appraisal policy; on success, emit an Attestation Result bound to the Exchange Identifier.<a href="#appendix-C.5-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="interop-notes">
<section id="appendix-C.6">
        <h3 id="name-interop-notes">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-interop-notes" class="section-name selfRef">Interop Notes</a>
        </h3>
<ul class="compact">
<li class="compact" id="appendix-C.6-1.1">
            <strong>Encodings:</strong> All binary fields referenced in EAT must be explicitly encoded (e.g., base64url) and stated as such in the claims table. NumericDate claims (<code>iat</code>, <code>nbf</code>, <code>exp</code>) use 64-bit unsigned integers.<a href="#appendix-C.6-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-C.6-1.2">
            <strong>Side-Channel Resistance:</strong> To mitigate timing attacks, implementations SHOULD use constant-time cryptographic comparisons. Payloads that are inputs to cryptographic operations (e.g., Evidence) MAY be padded to a fixed size using a length-prefix scheme to ensure unambiguous parsing.<a href="#appendix-C.6-1.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="concrete-example-continuous-tee-attestation-over-dtls">
<section id="appendix-D">
      <h2 id="name-concrete-example-continuous">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-concrete-example-continuous" class="section-name selfRef">Concrete Example: Continuous TEE Attestation over (D)TLS</a>
      </h2>
<p id="appendix-D-1">This appendix provides a complete example of attestation renewal for a long-running TEE workload using (D)TLS Exported Authenticators, integrating the work established by Fossati et al. <span>[<a href="#I-D.fossati-tls-exported-attestation" class="cite xref">I-D.fossati-tls-exported-attestation</a>]</span>.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div id="scenario">
<section id="appendix-D.1">
        <h3 id="name-scenario">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-scenario" class="section-name selfRef">Scenario</a>
        </h3>
<p id="appendix-D.1-1">We consider Server as Attester.
- Client establishes initial TLS 1.3 connection to TEE-based service
- Service performed bootstrap via ECA during provisioning
- Client needs to verify TEE health before processing sensitive data
- Service presents current measurements via attestation renewal<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-flow">
<section id="appendix-D.2">
        <h3 id="name-message-flow">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-message-flow" class="section-name selfRef">Message Flow</a>
        </h3>
<div class="alignLeft art-text artwork" id="appendix-D.2-1">
<pre>Client                              Server (TEE)
  |                                      |
  | TLS 1.3 Handshake                    |
  |&lt;------------------------------------&gt;|
  |                                      |
  | ClientCertificateRequest             |
  | {                                    |
  |   context: random_32_bytes,          |
  |   extensions: [cmw_attestation]      |
  | }                                    |
  |-------------------------------------&gt;|
  |                                      |
  |                         Generate TEE Quote:
  |                  REPORTDATA = hash(context)
  |                                      |
  | Authenticator                        |
  | {                                    |
  |   Certificate,                       |
  |   cmw_attestation: {                 |
  |     RF: signed_EAT_from_bootstrap,   |
  |     IF: TEE_Quote,                   |
  |     timestamp: current_time          |
  |   },                                 |
  |   CertificateVerify,                 |
  |   Finished                           |
  | }                                    |
  |&lt;-------------------------------------|
  |                                      |
  |  Validate:                           |
  |  - RF signature against known cert   |
  |  - Quote signature vs manuf. key     |
  |  - REPORTDATA binding to context     |
  |  - Measurements against CoRIM policy |
  |  - Timestamp freshness               |
  |                                      |
  | [Continue with application data]     |
</pre><a href="#appendix-D.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="validation-details">
<section id="appendix-D.3">
        <h3 id="name-validation-details">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-validation-details" class="section-name selfRef">Validation Details</a>
        </h3>
<p id="appendix-D.3-1"><strong>RF Verification:</strong>
- Extract public key from bootstrap EAT
- Verify signature on current Evidence
- Check EAT not expired<a href="#appendix-D.3-1" class="pilcrow">¶</a></p>
<p id="appendix-D.3-2"><strong>IF (TEE Quote) Verification:</strong>
- Verify Quote signature against TEE manufacturer key
- Confirm <code>REPORTDATA = SHA-256(certificate_request_context)</code>
- Appraise measurements against expected values (CoRIM)
- Validate TCB version meets minimum requirements<a href="#appendix-D.3-2" class="pilcrow">¶</a></p>
<p id="appendix-D.3-3"><strong>Context Binding:</strong>
- Ensures Quote was generated specifically for this request
- Prevents replay of old Quotes across sessions<a href="#appendix-D.3-3" class="pilcrow">¶</a></p>
<p id="appendix-D.3-4">This concrete flow is the reference for the renewal ProVerif model (<code>REPORTDATA = SHA-256(certificate_request_context)</code>), see []{#core-security-properties-renewal-model}.<a href="#appendix-D.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="app-evidence-profiles">
<section id="appendix-E">
      <h2 id="name-eat-profiles">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-eat-profiles" class="section-name selfRef">EAT profiles</a>
      </h2>
<div id="evidence-claims">
<section id="appendix-E.1">
        <h3 id="name-evidence-claims">
<a href="#appendix-E.1" class="section-number selfRef">E.1. </a><a href="#name-evidence-claims" class="section-name selfRef">Evidence Claims</a>
        </h3>
<table class="center" id="table-12">
          <caption><a href="#table-12" class="selfRef">Table 12</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Claim</th>
              <th class="text-left" rowspan="1" colspan="1">EAT Key</th>
              <th class="text-left" rowspan="1" colspan="1">Value Type</th>
              <th class="text-center" rowspan="1" colspan="1">M/O</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>ECA UUID</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">2 (sub)</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">The unique ceremony identifier. For SAE: <code>eca_uuid</code>. For (D)TLS: <code>certificate_request_context</code>.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Expiration</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">4 (exp)</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">NumericDate (epoch seconds). MUST be encoded as a 64-bit unsigned integer.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Not Before</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">5 (nbf)</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">NumericDate (epoch seconds). MUST be encoded as a 64-bit unsigned integer.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Issued At</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">6 (iat)</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">NumericDate (epoch seconds). MUST be encoded as a 64-bit unsigned integer.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Verifier Nonce</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">10 (nonce)</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">Verifier-issued freshness challenge (<strong>base64url</strong>, unpadded) representing exactly 16 bytes of entropy (typically 22 chars).</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>ECA Identity</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">256 (EUID)</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>eca_attester_id</code> = hex SHA-256 of the Ed25519 public key used to sign this EAT.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>EAT Profile</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">265</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">Profile identifier (e.g., <code>urn:ietf:params:eat:profile:eca-v1</code>).</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Measurements</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">273</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">Integrity Hash Beacon (IHB) (<strong>lowercase hex</strong>).</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>pop_tag</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">274</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">
                <code>pop_tag</code> Cryptographic proof binding <code>BF</code>+<code>VF</code> to session context</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Intended Use</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">275</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-center" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1">The intended use of the EAT (e.g., attestation, enrollment credential binding).</td>
            </tr>
          </tbody>
        </table>
<p id="appendix-E.1-2">Values marked "tstr" that carry binary material (e.g., nonces, tags) MUST specify their encoding. Profile specifications MUST define exact encodings for all binary claims.<a href="#appendix-E.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attestation-results">
<section id="appendix-E.2">
        <h3 id="name-attestation-results">
<a href="#appendix-E.2" class="section-number selfRef">E.2. </a><a href="#name-attestation-results" class="section-name selfRef">Attestation Results</a>
        </h3>
<table class="center" id="table-13">
          <caption><a href="#table-13" class="selfRef">Table 13</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Claim</th>
              <th class="text-left" rowspan="1" colspan="1">Key</th>
              <th class="text-left" rowspan="1" colspan="1">Value Type</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Issuer</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-left" rowspan="1" colspan="1">An identifier for the Verifier that produced the result.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Subject</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-left" rowspan="1" colspan="1">The <code>eca_attester_id</code> identity of the instance that was successfully attested.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Expiration</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">4 (exp)</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONAL. NumericDate defining the AR's validity period.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Not Before</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">5 (nbf)</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONAL. NumericDate defining the AR's validity period.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Issued At</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">NumericDate (epoch seconds) of the successful validation.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>JWT ID</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-left" rowspan="1" colspan="1">The unique ceremony identifier to prevent replay.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Key ID</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">-1 (kid)</td>
              <td class="text-left" rowspan="1" colspan="1">bstr</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONAL. The hash of the Verifier's public key used to sign the AR.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <strong>Status</strong>
</td>
              <td class="text-left" rowspan="1" colspan="1">-262148</td>
              <td class="text-left" rowspan="1" colspan="1">tstr</td>
              <td class="text-left" rowspan="1" colspan="1">The outcome of the attestation. MUST be <code>urn:ietf:params:rats:status:success</code>.</td>
            </tr>
          </tbody>
        </table>
<p id="appendix-E.2-2">For failures, the AR payload SHOULD follow the same structure but with a <code>status</code> of <code>urn:ietf:params:rats:status:failure</code> and an additional <code>error_code</code> claim (e.g., -262149 as a <code>tstr</code>) containing the authenticated error. Relying Parties consuming the AR MUST validate the <code>nbf</code> and <code>exp</code> claims to ensure the AR is within its validity period.<a href="#appendix-E.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="app-errors">
<section id="appendix-F">
      <h2 id="name-eca-sae-error-codes-registr">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-eca-sae-error-codes-registr" class="section-name selfRef">ECA/SAE Error Codes Registry</a>
      </h2>
<p id="appendix-F-1">This registry defines application-specific error codes that are used in addition to the base error codes defined in <span>[<a href="#I-D.ritz-sae" class="cite xref">I-D.ritz-sae</a>]</span>.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<table class="center" id="table-14">
        <caption><a href="#table-14" class="selfRef">Table 14</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Code</th>
            <th class="text-left" rowspan="1" colspan="1">Canonical Content (UTF-8)</th>
            <th class="text-left" rowspan="1" colspan="1">Gate</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>MAC_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>MAC_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">Provided MAC was invalid.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>ID_MISMATCH</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>ID_MISMATCH</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">Provided instance identity was invalid.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>IHB_MISMATCH</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>IHB_MISMATCH</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">Recomputed IHB did not match expected value.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>KEM_MISMATCH</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>KEM_MISMATCH</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">Did not get expected KEM key for the session.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>TIME_EXPIRED</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>TIME_EXPIRED</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">Evidence timestamp was outside valid time window.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>SCHEMA_ERROR</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>SCHEMA_ERROR</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">Attestation token failed schema validation.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>SIG_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>SIG_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">Attestation token signature failed.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>NONCE_MISMATCH</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>NONCE_MISMATCH</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">8</td>
            <td class="text-left" rowspan="1" colspan="1">Nonce in the EAT did not match the issued nonce.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>POP_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>POP_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">9</td>
            <td class="text-left" rowspan="1" colspan="1">The pop_tag (PoP) was invalid.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>PUBLISHER_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>PUBLISHER_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Attester artifacts were observed at a repository not hosted by the Attester.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>TIMEOUT_PHASE1</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>TIMEOUT_PHASE1</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Attester failed to publish Phase 1 artifacts within timeout</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>TIMEOUT_PHASE2</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>TIMEOUT_PHASE2</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Attester failed to publish Phase 2 artifacts within timeout</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>TRANSPORT_ERROR</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>TRANSPORT_ERROR</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Underlying transport protocol error</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>CREDENTIAL_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>CREDENTIAL_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Renewal Factor signature failed verification</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>MEASUREMENT_REJECTED</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>MEASUREMENT_REJECTED</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Instance Factor measurements failed policy appraisal</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>REPLAY_DETECTED</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>REPLAY_DETECTED</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Attestation procedure ID was reused</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">
              <code>BINDING_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">
              <code>BINDING_INVALID</code>
</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">Freshness binding check failed</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="change-log">
<section id="appendix-G">
      <h2 id="name-change-log">
<a href="#appendix-G" class="section-number selfRef">Appendix G. </a><a href="#name-change-log" class="section-name selfRef">Change log</a>
      </h2>
<div id="changes-since-00">
<section id="appendix-G.1">
        <h3 id="name-changes-since-00">
<a href="#appendix-G.1" class="section-number selfRef">G.1. </a><a href="#name-changes-since-00" class="section-name selfRef">Changes since -00</a>
        </h3>
<p id="appendix-G.1-1">This revision represents a significant architectural evolution of the ECA protocol based on deeper understanding of the existing Attestation landscape. The scope has been expanded from a single identity bootstrap procedure to a comprehensive attestation pattern.<a href="#appendix-G.1-1" class="pilcrow">¶</a></p>
<div id="major-architectural-changes">
<section id="appendix-G.1.1">
          <h4 id="name-major-architectural-changes">
<a href="#appendix-G.1.1" class="section-number selfRef">G.1.1. </a><a href="#name-major-architectural-changes" class="section-name selfRef">Major Architectural Changes</a>
          </h4>
<ul class="normal">
<li class="normal" id="appendix-G.1.1-1.1">
              <p id="appendix-G.1.1-1.1.1"><strong>Dual-Attestation Model:</strong> The protocol is no longer a single three-phase attestation procedure. It now defines two distinct but related attestation procedures:<a href="#appendix-G.1.1-1.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="appendix-G.1.1-1.1.2">
<li id="appendix-G.1.1-1.1.2.1">
                  <strong>Identity Bootstrapping:</strong> For initial "cold start" establishment of verifiable identity in environments not yet provisioned.<a href="#appendix-G.1.1-1.1.2.1" class="pilcrow">¶</a>
</li>
                <li id="appendix-G.1.1-1.1.2.2">
                  <strong>Attestation Renewal:</strong> A lightweight, single round-trip attestation procedure for continuous verification of an established identity, ideal for long-running workloads and TEEs.<a href="#appendix-G.1.1-1.1.2.2" class="pilcrow">¶</a>
</li>
              </ol>
</li>
            <li class="normal" id="appendix-G.1.1-1.2">
              <p id="appendix-G.1.1-1.2.1"><strong>New Session-Bound Deployment Model:</strong> A primary deployment model using <strong>(D)TLS Exported Authenticators</strong> has been introduced. This aligns the protocol with the <strong>SEAT WG charter</strong> and directly supports continuous attestation for Trusted Execution Environments (TEEs).<a href="#appendix-G.1.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.1-1.3">
              <p id="appendix-G.1.1-1.3.1"><strong>Preliminary Formal Model of Attestation Renewal:</strong> Exploratory formal modeling and analysis of the attestation renewal model has been completed.<a href="#appendix-G.1.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.1-1.4">
              <p id="appendix-G.1.1-1.4.1"><strong>Consolidation of Implementation Guide:</strong> Key concepts from the separate implementation guide (<code>draft-ritz-eca-impl-00</code>) have been merged into this core specification for clarity and completeness. This includes:<a href="#appendix-G.1.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="compact normal">
<li class="compact normal" id="appendix-G.1.1-1.4.2.1">
                  <strong>Instance Factor Patterns (IFP):</strong> The Hardware-Rooted (A), Orchestrator-Provisioned (B), and Artifact-Based (C) patterns are now formally part of the core draft.<a href="#appendix-G.1.1-1.4.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact normal" id="appendix-G.1.1-1.4.2.2">
                  <strong>Reference Profile and Examples:</strong> A concrete reference profile (<code>ECA-VM-BOOTSTRAP-V1</code>) and a detailed (D)TLS example have been included as appendices.<a href="#appendix-G.1.1-1.4.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact normal" id="appendix-G.1.1-1.4.2.3">
                  <strong>Implementation Status:</strong> The section detailing the prototype's status is now included.<a href="#appendix-G.1.1-1.4.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-G.1.1-1.5">
              <p id="appendix-G.1.1-1.5.1">**Removed SAE from RECOMMENDED or normative transport requirements. Preliminary formal modeling and validation demonstrates that SAE is not required to maintain the security properties inherent in the logic of the applied cryptography.<a href="#appendix-G.1.1-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.1-1.6">
              <p id="appendix-G.1.1-1.6.1">**Removed chaining and heirachal trust section (attestation renewal is a stronger example of AR re-use)<a href="#appendix-G.1.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="scope-and-terminology-refinements">
<section id="appendix-G.1.2">
          <h4 id="name-scope-and-terminology-refin">
<a href="#appendix-G.1.2" class="section-number selfRef">G.1.2. </a><a href="#name-scope-and-terminology-refin" class="section-name selfRef">Scope and Terminology Refinements</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.1.2-1.1">
              <strong>Protocol Renaming:</strong> The draft is now titled <strong>"Entity and Compute Attestation"</strong> (formerly "Ephemeral Compute Attestation") to reflect its broadened applicability to both ephemeral and long-running entities.<a href="#appendix-G.1.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.1.2-1.2">
              <strong>New Terminology:</strong> Introduced new core terms to support the Dual-Attestation model, most notably the <strong>Renewal Factor (RF)</strong>, which is the credential used to prove identity continuity in attestation renewal procedures. The roles of <strong>Binding Factor (BF)</strong> and <strong>Instance Factor (IF)</strong> have been clarified for each attestation procedure type. Added <strong>Verifying Relying Party (VRP)</strong> to clarify roles in renewal procedures. Clarified the distinction between <strong>Evidence</strong> (from Attester) and <strong>Attestation Result</strong> (from Verifier).<a href="#appendix-G.1.2-1.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="expanded-integration-and-use-cases">
<section id="appendix-G.1.3">
          <h4 id="name-expanded-integration-and-us">
<a href="#appendix-G.1.3" class="section-number selfRef">G.1.3. </a><a href="#name-expanded-integration-and-us" class="section-name selfRef">Expanded Integration and Use Cases</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-G.1.3-1.1">
              <strong>WIMSE and SEAT Alignment:</strong> The document now explicitly maps ECA roles and concepts to the <strong>WIMSE (Workload Identity in Multi-Cloud Secure Environments)</strong> architecture and details its alignment with the proposed <strong>SEAT (Secure Evidence and Attestation Transport)</strong> working group's goals.<a href="#appendix-G.1.3-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-G.1.3-1.2">
              <strong>Post-Attestation Patterns:</strong> Added a new section that describes the credential lifecycle, stateful attestation renewal, and patterns for chaining attestations to build hierarchical trust.<a href="#appendix-G.1.3-1.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="editorial-changes">
<section id="appendix-G.1.4">
          <h4 id="name-editorial-changes">
<a href="#appendix-G.1.4" class="section-number selfRef">G.1.4. </a><a href="#name-editorial-changes" class="section-name selfRef">Editorial Changes</a>
          </h4>
<ul class="normal">
<li class="normal" id="appendix-G.1.4-1.1">Added <strong>Muhammad Usama Sardar</strong> as a co-author.<a href="#appendix-G.1.4-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-G.1.4-1.2">Retained ECA-VM-BOOTSTRAP-V1 profile for interop testing<a href="#appendix-G.1.4-1.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-G.1.4-1.3">Replaced "ceremony" with "attestation procedure" or simply "procedure".<a href="#appendix-G.1.4-1.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-G.1.4-1.4">Replaced "re-attestation" with "attestation renewals"<a href="#appendix-G.1.4-1.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-G.1.4-1.5">Updated the preliminary formal model analysis in the appendix to reflect the protocol's evolution and provide clearer interpretations of the security boundary tests.<a href="#appendix-G.1.4-1.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-G.1.4-1.6">
              <p id="appendix-G.1.4-1.6.1">Integrated normative profiles from <code>interop-profiles.md</code> as new appendices<a href="#appendix-G.1.4-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.4-1.7">
              <p id="appendix-G.1.4-1.7.1">Restructured the document significantly to introduce the conceptual model and deployment patterns upfront.<a href="#appendix-G.1.4-1.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.4-1.8">
              <p id="appendix-G.1.4-1.8.1">The document flow has been improved by moving the "Non-Goals" section up to follow "Motivation and Use Cases".<a href="#appendix-G.1.4-1.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.4-1.9">
              <p id="appendix-G.1.4-1.9.1">A new "Deployment Patterns and Examples" section has been added to provide concrete examples of the protocol in use (Developer Workflow, Production Cloud, High-Assurance).<a href="#appendix-G.1.4-1.9.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.4-1.10">
              <p id="appendix-G.1.4-1.10.1">The "Instance Factor Patterns (IFP)" appendix has been integrated directly into the "Conceptual Model" section for better context.<a href="#appendix-G.1.4-1.10.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.4-1.11">
              <p id="appendix-G.1.4-1.11.1">Expanded the "Relationship with other RATS initiatives" section to explicitly detail alignment with Posture Assessment drafts and CoRIM.<a href="#appendix-G.1.4-1.11.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-G.1.4-1.12">
              <p id="appendix-G.1.4-1.12.1">Removed the "Introduction" section, merging its content into the abstract and motivation sections.<a href="#appendix-G.1.4-1.12.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="protocol-refinement">
<section id="appendix-G.2">
        <h3 id="name-protocol-refinement">
<a href="#appendix-G.2" class="section-number selfRef">G.2. </a><a href="#name-protocol-refinement" class="section-name selfRef">Protocol Refinement</a>
        </h3>
<ul class="compact">
<li class="compact" id="appendix-G.2-1.1">The separate <code>PoP</code> and <code>JP Proof</code> claims in the EAT Evidence have been consolidated into a single <code>pop_tag</code> claim. This simplifies the final proof and its verification.<a href="#appendix-G.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-G.2-1.2">The <code>ECA-VM-BOOTSTRAP-V1</code> MTI profile has been updated to reflect the new single binding proof construction.<a href="#appendix-G.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-G.2-1.3">BREAKING CHANGE: The EAT <code>Evidence</code> payload has been modified. The separate <code>PoP</code> (EAT Key 274) and <code>JP Proof</code> (EAT Key 276) claims are replaced by a single consolidated <code>pop_tag</code> claim (EAT Key 274). Implementations must be updated to use the new proof construction method defined in the reference profile.<a href="#appendix-G.2-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-H">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nathanael Ritz</span></div>
<div dir="auto" class="left"><span class="org">Independent</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nathanritz@gmail.com" class="email">nathanritz@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Muhammad Usama Sardar</span></div>
<div dir="auto" class="left"><span class="org">TU Dresden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:muhammad_usama.sardar@tu-dresden.de" class="email">muhammad_usama.sardar@tu-dresden.de</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
